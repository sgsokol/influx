
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>User’s manual &#8212; influx_si 7.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/classic.css" />
    
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="FTBL format evolution" href="ftblevo.html" />
    <link rel="prev" title="Quick Start" href="quick.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="ftblevo.html" title="FTBL format evolution"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="quick.html" title="Quick Start"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">influx_si 7.0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">User’s manual</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="user-s-manual">
<h1>User’s manual<a class="headerlink" href="#user-s-manual" title="Permalink to this heading">¶</a></h1>
<section id="mtf-format">
<span id="mtf"></span><h2>MTF format<a class="headerlink" href="#mtf-format" title="Permalink to this heading">¶</a></h2>
<p>Let start by describing file formats used by <code class="docutils literal notranslate"><span class="pre">influx_si</span></code>.
MTF (Multiple TSV files) format was introduced in v6.0 of <code class="docutils literal notranslate"><span class="pre">influx_si</span></code> and was developed in collaboration and on demand from <a class="reference external" href="https://www.toulouse-biotechnology-institute.fr/en/plateformes-plateaux/metatoul/">MetaToul-FluxoMet platform</a> and <a class="reference external" href="https://www.toulouse-biotechnology-institute.fr/en/poles/equipe-metasys/">MetaSys team</a> of Toulouse Biotechnology Institute. Since v7.0, MTF is also used for output files.</p>
<p>Originally, MTF introduction came in replacement to FTBL format and served several purposes:</p>
<blockquote>
<div><ul class="simple">
<li><p>to simplify network and other information formatting;</p></li>
<li><p>to allow multiplexing of constant and variable information for large experience series. E.g., a same network can be tested under several biological conditions or vice versa a given data set can be confronted to different network models to see which one can better fit it;</p></li>
<li><p>to facilitate automatic assembling of network/data/options coming from tiers workflows such as MS or NMR data treatment.</p></li>
</ul>
<p>Even if FTBL format was replaced as front-end format in <code class="docutils literal notranslate"><span class="pre">influx_si</span></code>, it is still a valid
format for calculation and continues to be used behind the scene in accompanying utilities.</p>
</div></blockquote>
<p>MTF format is composed of a series of plain text (tab separated when necessary) files, each having a particular role and designated by their suffixes:</p>
<blockquote>
<div><dl class="simple">
<dt>.netw</dt><dd><p>describes biochemical reactions and label transitions.</p>
</dd>
<dt>.linp</dt><dd><p>describes label inputs forms and fractions</p>
</dd>
<dt>.miso</dt><dd><p>describes stationary and instationary label measurements, their type, value, and standard deviation</p>
</dd>
<dt>.mflux</dt><dd><p>describes stationary net flux measurements (e.g., substrate consumption or product secretion)</p>
</dd>
<dt>.mmet</dt><dd><p>describes stationary concentration measurements</p>
</dd>
<dt>.cnstr</dt><dd><p>describes constraints, equality or inequality type, on fluxes and concentrations</p>
</dd>
<dt>.tvar</dt><dd><p>describes variable type such as Free, Constrained or Dependent with possible starting values for Free variables</p>
</dd>
<dt>.opt</dt><dd><p>describes options such as optimization parameters, post-treatment R scripts to execute and others</p>
</dd>
</dl>
</div></blockquote>
<p>These suffixes will be used throughout this manual, as they facilitate <code class="docutils literal notranslate"><span class="pre">influx_si</span></code> usage. But they are not mandatory. For example, a classical .tsv or .txt suffixes can be used instead. In this case, a file meaning can be indicated in <code class="docutils literal notranslate"><span class="pre">--mtf</span></code> option of <code class="docutils literal notranslate"><span class="pre">influx_si</span></code> of <code class="docutils literal notranslate"><span class="pre">txt2ftbl</span></code>, e.g. <code class="docutils literal notranslate"><span class="pre">--mtf</span> <span class="pre">netw=ecoli.txt,miso=gcms.tsv,linp=glucoseU.8.tsv</span></code></p>
<p>Only the first 3 are mandatory as input files, the rest of MTF set is optional.</p>
<p>Now, we pass in more detailed review each of the file content.</p>
<section id="netw">
<h3>.netw<a class="headerlink" href="#netw" title="Permalink to this heading">¶</a></h3>
<p>This is a central file to the rest of the work – network file .netw
It represents a list of biochemical reactions with label transitions. Here is an example of such reaction:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>edd: Gnt6P <span class="o">(</span>ABCDEF<span class="o">)</span> -&gt; Pyr <span class="o">(</span>ABC<span class="o">)</span> + GA3P <span class="o">(</span>DEF<span class="o">)</span>
</pre></div>
</div>
<dl>
<dt>Let detail its elements (all reaction elements are case-sensitive):</dt><dd><dl>
<dt><code class="docutils literal notranslate"><span class="pre">edd</span></code></dt><dd><p>the unique reaction name</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">:</span></code></dt><dd><p>name-reaction separator</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Gnt6P</span></code>, <code class="docutils literal notranslate"><span class="pre">Pyr</span></code>, <code class="docutils literal notranslate"><span class="pre">GA3P</span></code></dt><dd><p>reactant names. They must not contain <code class="docutils literal notranslate"><span class="pre">+</span></code>, <code class="docutils literal notranslate"><span class="pre">(</span></code>, <code class="docutils literal notranslate"><span class="pre">)</span></code>. Other common separators such as <code class="docutils literal notranslate"><span class="pre">:</span></code>, <code class="docutils literal notranslate"><span class="pre">;</span></code> and special characters such as <code class="docutils literal notranslate"><span class="pre">{</span></code>, <code class="docutils literal notranslate"><span class="pre">|</span></code>, …  are to avoid. However, other than Latin alphabet letters are welcome in UTF-8 encoding, e.g. <code class="docutils literal notranslate"><span class="pre">α</span></code>, <code class="docutils literal notranslate"><span class="pre">β</span></code> etc.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">(ABCDEF)</span></code>, <code class="docutils literal notranslate"><span class="pre">(ABC)</span></code>, <code class="docutils literal notranslate"><span class="pre">(DEF)</span></code></dt><dd><p>are labels of reactants. Here, their meaning is that first 3 carbons of <code class="docutils literal notranslate"><span class="pre">Gnt6P</span></code> goes to <code class="docutils literal notranslate"><span class="pre">Pyr</span></code> in the same order and the rest goes to <code class="docutils literal notranslate"><span class="pre">GA3P</span></code> also in the same order. Label atom numbering is left free for user’s choice but once chosen, it must remain consistent between reactions. It is advised to follow some common conventions. E.g., the most oxidized carbon atom (if it is a carbon which is used for labeling) should have number 1 (here letter <code class="docutils literal notranslate"><span class="pre">A</span></code> in <code class="docutils literal notranslate"><span class="pre">Gnt6P</span></code> and <code class="docutils literal notranslate"><span class="pre">Pyr</span></code>, and letter <code class="docutils literal notranslate"><span class="pre">D</span></code> in <code class="docutils literal notranslate"><span class="pre">GA3P</span></code>). Its neighbor has number 2 etc. <code class="docutils literal notranslate"><span class="pre">influx_si</span></code> does not impose to use ¹³C as labeling atom. User is free to use any other atom or even a combination of them, e.g., ¹³C and ¹⁵N. A reactant can be without label atoms. In this case, it will participate in mass balance but not in label balance. Such situation can be useful e.g., for co-factors, e.g., ATP/ADP, NADP/NADPH etc. if they are not synthesized in the modeled network. The left opening parenthesis of the label pattern must be separated by a space from a precedent reactant name. The label identifiers can be composed of Latin or foreign letters as well as digits, each symbol representing one label atom. If a label symbol is present on one reaction side, it must be present as well on the other side. Each symbol must be present only once, except for so called “scrambling” label molecules. For example, Formate is a symmetric molecule from carbon point of view. So, its labeling can be given as <code class="docutils literal notranslate"><span class="pre">(ABCD+DCBA)</span></code>. Thus, for example, a letter <code class="docutils literal notranslate"><span class="pre">A</span></code> appearing on the other side of reaction can come from both ends of Formate.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">-&gt;</span></code></dt><dd><p>reaction left and right side separator. Here, the reaction is indicated as non-reversible, i.e., exchange flux is imposed to be 0. However, the net flux can be either positive or negative. For a positive net flux, the reactants on the left are consumed and those on the right are produced. If user wishes to impose the sens of reaction, a sign <code class="docutils literal notranslate"><span class="pre">-&gt;&gt;</span></code> can be used. In this case, the net flux is imposed to be non-negative (i.e. ≥ 0). For reversible reactions, a sign <code class="docutils literal notranslate"><span class="pre">&lt;-&gt;</span></code> can be used. A sign <code class="docutils literal notranslate"><span class="pre">&lt;-&gt;&gt;</span></code> is meaningful. It indicates that a reaction is reversible, but the net flux must be non-negative. A non-zero exchange flux for a positive net flux can be responsible for a backward label propagation.</p>
<p>Input/output reactions must have exchange flux set to 0. So they can be edited either with <code class="docutils literal notranslate"><span class="pre">-&gt;</span></code> or <code class="docutils literal notranslate"><span class="pre">-&gt;&gt;</span></code>. This is necessary to distinguish them from reactions having so-called “dead-end” reactants. They occur only on one side of reaction(s) (either left or right, like input/output reactants do) but have an exchange flux different from 0. The dead-ends are rarely desirable and most often result from network topology errors or simply leaving <code class="docutils literal notranslate"><span class="pre">&lt;-&gt;</span></code> where <code class="docutils literal notranslate"><span class="pre">-&gt;</span></code> is meant. However, there are some special situations when they can be used on purpose in <code class="docutils literal notranslate"><span class="pre">influx_i</span></code>, for example, for modeling label dilution from stock species.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">+</span></code></dt><dd><p>reactant separator. The surrounding spaces are mandatory.</p>
</dd>
</dl>
<p>In the above reaction example, all stoichiometric coefficients are 1. If it is not the case in some reaction, they can be given as plain number (integer or with decimal point) preceding a reactant name and separated by an optional <code class="docutils literal notranslate"><span class="pre">*</span></code> sign (it can be replaced by a space), e.g.:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>v47:  Ser <span class="o">(</span>abc<span class="o">)</span> + AcCoA <span class="o">(</span>de<span class="o">)</span> + <span class="m">3</span>.0*ATP <span class="o">()</span> + <span class="m">4</span>.0*NADPH <span class="o">()</span> + SO4 <span class="o">()</span> -&gt; Cys <span class="o">(</span>abc<span class="o">)</span> + Ac <span class="o">(</span>de<span class="o">)</span>
</pre></div>
</div>
<p>Note that coefficients different from 1 can only be used with non labeled reactants.</p>
<p>A comment can be introduced by <code class="docutils literal notranslate"><span class="pre">#</span></code>. The line content starting from this character to the end of the line is simply ignored with one exception: a triple hash sign <code class="docutils literal notranslate"><span class="pre">###</span></code> at the line beginning is used to introduce a pathway name. Pathway name can be useful for <code class="docutils literal notranslate"><span class="pre">ftbl2metxml.py</span></code> script which prepare xml and txt files for visualization on a partner site <a class="reference external" href="https://metexplore.toulouse.inra.fr/">MetExplore</a>.</p>
</dd>
</dl>
</section>
<section id="linp">
<h3>.linp<a class="headerlink" href="#linp" title="Permalink to this heading">¶</a></h3>
<p>Label input can be indicated in .linp file. Starting from this file type, the rest of the files are in TSV (tab separated values) format. I.e. they are plain text files where data are organized in tables, one table row per file line and where columns are separated with the tabulation character. The first non commented row contains column names. The comments start with <code class="docutils literal notranslate"><span class="pre">#</span></code> sign, they are simply ignored till the end of the row where they occur. The left- and right-trailing white spaces are stripped.</p>
<dl>
<dt>The .linp file can contain the following column names:</dt><dd><dl>
<dt><code class="docutils literal notranslate"><span class="pre">Id</span></code></dt><dd><p>Not used by <code class="docutils literal notranslate"><span class="pre">influx_si</span></code> but can be useful for user’s information tracking system.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Comment</span></code></dt><dd><p>Not used by <code class="docutils literal notranslate"><span class="pre">influx_si</span></code> but left for user’s convenience.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Specie</span></code></dt><dd><p>Chemical specie name such as used in reactions in .netw file, e.g. <code class="docutils literal notranslate"><span class="pre">Glucose</span></code></p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Isotopomer</span></code></dt><dd><p>Particular isotopomer form used as label entry and composed only of “0”s and “1”s, e.g. <code class="docutils literal notranslate"><span class="pre">111111</span></code> for uniformly labeled Glucose, <code class="docutils literal notranslate"><span class="pre">100000</span></code> for Glucose labeled in first carbon.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Value</span></code></dt><dd><p>For step-wise labeling experiments, a number between 0 and 1 indicating a fraction of the given labeled form in the mix. For experiments with labeling varying in time, a R expression describing time dependent function for the given label form.</p>
<p>Normally, all labeling form for a given specie must sum up to 1. If they don’t, the following conventions apply:</p>
<ul class="simple">
<li><p><em>“the rest is unlabeled”</em>: if many labeling forms are lacking in the file (including fully unlabeled specie) then the fully unlabeled form (e.g. <code class="docutils literal notranslate"><span class="pre">000000</span></code> for Glucose) is considered as completing the set to 1;</p></li>
<li><p><em>“guess the lacking one”</em>: if only one form is lacking in the file (no matter which one), then its fractions is considered as completing the present set to 1.</p></li>
</ul>
<p>Here is a complete example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Id      Comment Specie  Isotopomer      Value
                Gluc_U  <span class="m">111111</span>          <span class="m">1</span>
                Gluc_U  <span class="m">000000</span>          <span class="m">0</span>.
                Gluc_1  <span class="m">100000</span>          <span class="m">1</span>.
                Gluc_1  <span class="m">000000</span>          <span class="m">0</span>.
</pre></div>
</div>
<p>which can be shortened, due to above conventions, to:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Id      Comment Specie  Isotopomer      Value
                Gluc_U  <span class="m">111111</span>          <span class="m">1</span>
                Gluc_1  <span class="m">100000</span>          <span class="m">1</span>.
</pre></div>
</div>
</dd>
</dl>
</dd>
</dl>
</section>
<section id="miso">
<h3>.miso<a class="headerlink" href="#miso" title="Permalink to this heading">¶</a></h3>
<p>The .miso contains and describes labeled measurements.
This file contains the following column names:</p>
<blockquote>
<div><dl>
<dt><code class="docutils literal notranslate"><span class="pre">Id</span></code></dt><dd><p>Not used by <code class="docutils literal notranslate"><span class="pre">influx_si</span></code> but can be useful for user’s information tracking system.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Comment</span></code></dt><dd><p>Not used by <code class="docutils literal notranslate"><span class="pre">influx_si</span></code> but left for user’s convenience.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Specie</span></code></dt><dd><p>Specie names such as used in reactions in .netw file, e.g. <code class="docutils literal notranslate"><span class="pre">Glucose</span></code></p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Fragment</span></code></dt><dd><p>Integer sequences or intervals describing label fragment used in a given measurement, e.g. <code class="docutils literal notranslate"><span class="pre">1-3</span></code> or <code class="docutils literal notranslate"><span class="pre">1,2,3</span></code> or <code class="docutils literal notranslate"><span class="pre">2-5,7,9-11</span></code>. Empty field means that the entire molecule is measured.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Dataset</span></code></dt><dd><p>Any character sequence identifying measurement method. It can be useful for distinguishing measurements on the same combination specie/fragment. Examples: <code class="docutils literal notranslate"><span class="pre">MS-1</span></code>, <code class="docutils literal notranslate"><span class="pre">HSQC</span></code>. A given dataset can have its own scaling factor if they are in use.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Isospecies</span></code></dt><dd><p>For MS measurements, a <code class="docutils literal notranslate"><span class="pre">M0</span></code>, <code class="docutils literal notranslate"><span class="pre">M1</span></code> etc. isotopologue identification. For NMR label measurements, a combination of binary cumomers involved in measurements. They are separated by “+” sign. Each binary cumomer can be composed of “0”, “1” and “x” symbols, e.g. <code class="docutils literal notranslate"><span class="pre">01x+10x</span></code>. This notation is universal enough to describe any NMR (or even MS) method. However, for methods focused on a particular specie fragment, it can be more practical to use notation “label transferring” like <code class="docutils literal notranslate"><span class="pre">2-&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">2-&gt;1</span></code>, <code class="docutils literal notranslate"><span class="pre">2-&gt;3</span></code> and <code class="docutils literal notranslate"><span class="pre">2-&gt;1,3</span></code>. Here, the second atom is labeled and in a given measurement method it interacts:</p>
<blockquote>
<div><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">2-&gt;</span></code></dt><dd><p>with no other atom (given a singlet peak);</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">2-&gt;1</span></code></dt><dd><p>with labeled atom 1 (giving a peak doublet 1);</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">2-&gt;3</span></code></dt><dd><p>then labeled atom 3 (giving peak doublet 2);</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">2-&gt;1,3</span></code></dt><dd><p>and finally with both labeled atoms 1 and 3 (doublet of doublets).</p>
</dd>
</dl>
</div></blockquote>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Value</span></code></dt><dd><p>Measured value in floating point notation. Can be empty or NA, meaning “non-available”. There is a difference between a measurement absent in file and a measurement with NA value. The former is simply ignored, while the latter is simulated and reported is simulated measurements.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">SD</span></code></dt><dd><p>Standard deviation value in floating point notation. Cannot be empty, neither NA. We recall that SD is characterizing a given measurement technique, not its particular realization. So it is perfectly possible to have only one measurements if SD of the given technique was already estimated from previous experiments. If the <code class="docutils literal notranslate"><span class="pre">Value</span></code> contains an average of <span class="math notranslate nohighlight">\(n\)</span> measurements, than a standard SD should be reduced by a factor <span class="math notranslate nohighlight">\(\sqrt{n}\)</span></p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Time</span></code></dt><dd><p>For instationary labeling, the time point to which a given measurement corresponds. For stationary labeling, must be empty.</p>
</dd>
</dl>
</div></blockquote>
<p>A multi-line example is the following:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Id      Comment Specie  Fragment        Dataset Isospecies      Value           SD      Time
                GA3P                    LAB-10  1xx             <span class="m">0</span>.03304418      <span class="m">0</span>.002
                GA3P                    LAB-11  x1x             <span class="m">0</span>.01260362      <span class="m">0</span>.002
                GA3P                    LAB-12  xx1             <span class="m">0</span>.1207158       <span class="m">0</span>.002
                PEP     <span class="m">1</span>,2             PEAK-1  <span class="m">1</span>-&gt;             <span class="m">0</span>.66            <span class="m">0</span>.005
                PEP     <span class="m">1</span>,2             PEAK-1  <span class="m">1</span>-&gt;2            <span class="m">0</span>.01            <span class="m">0</span>.005
                PEP     <span class="m">1</span>,2,3           PEAK-2  <span class="m">2</span>-&gt;             <span class="m">1</span>.26            <span class="m">0</span>.005
                PEP     <span class="m">1</span>,2,3           PEAK-2  <span class="m">2</span>-&gt;1            <span class="m">0</span>.03960991      <span class="m">0</span>.005
                PEP     <span class="m">1</span>,2,3           PEAK-2  <span class="m">2</span>-&gt;3            <span class="m">0</span>.01183004      <span class="m">0</span>.005
                PEP     <span class="m">1</span>,2,3           PEAK-2  <span class="m">2</span>-&gt;1,3          <span class="m">0</span>.0007686513    <span class="m">0</span>.005
                PEP     <span class="m">1</span>,2,3           MS-1    M0              <span class="m">12601</span>           <span class="m">68</span>.005
                PEP     <span class="m">1</span>,2,3           MS-1    M1              <span class="m">2301</span>            <span class="m">16</span>.505
                PEP     <span class="m">1</span>,2,3           MS-1    M2              <span class="m">96</span>              <span class="m">5</span>.48
                PEP     <span class="m">1</span>,2,3           MS-1    M3              <span class="m">1</span>               <span class="m">5</span>.005
</pre></div>
</div>
<p>Here, column <code class="docutils literal notranslate"><span class="pre">Time</span></code> is left empty intentionally, thus signaling a stationary labeling.</p>
</section>
<section id="mflux">
<h3>.mflux<a class="headerlink" href="#mflux" title="Permalink to this heading">¶</a></h3>
<p>Starting from this file format, we consider that column names are either similar to already described or are self-explanatory, and we will just give multi-line examples with few possible comments. So, for net flux stationary measurements, we could have:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Id      Comment Flux    Value   SD
                upt     <span class="m">1</span>.02    <span class="m">0</span>.05
</pre></div>
</div>
</section>
<section id="mmet">
<h3>.mmet<a class="headerlink" href="#mmet" title="Permalink to this heading">¶</a></h3>
<p>For stationary specie concentration, we could have:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Id   Comment Specie  Value                   SD
             Fru6P   <span class="m">0</span>.4263681348074568      <span class="m">0</span>.01
             GA3P    <span class="m">0</span>.469998855791378       <span class="m">0</span>.01
</pre></div>
</div>
</section>
<section id="cnstr">
<h3>.cnstr<a class="headerlink" href="#cnstr" title="Permalink to this heading">¶</a></h3>
<p>Constraints on fluxes and specie concentrations can look like:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Id      Comment Kind    Formula                 Operator        Value
                NET     Glucupt_1+Glucupt_U     <span class="o">==</span>              <span class="m">1</span>
                NET     edd                     &gt;<span class="o">=</span>              <span class="m">0</span>.0001
</pre></div>
</div>
<p>Column <code class="docutils literal notranslate"><span class="pre">Kind</span></code> indicates if a constraint is on net fluxes: <code class="docutils literal notranslate"><span class="pre">NET</span></code>; on exchange fluxes: <code class="docutils literal notranslate"><span class="pre">XCH</span></code> or on specie concentrations: <code class="docutils literal notranslate"><span class="pre">MET</span></code>. The <code class="docutils literal notranslate"><span class="pre">Formula</span></code> content must be a linear function of involved entities. If numeric factors are involved in the formula, they must preceed the variable name, e.g. <code class="docutils literal notranslate"><span class="pre">0.632*BM</span></code> and not <code class="docutils literal notranslate"><span class="pre">BM*0.632</span></code>. Column <code class="docutils literal notranslate"><span class="pre">Value</span></code> can have either a float number or a simple Python arithmetic expression which evaluates to a float number, e.g. <code class="docutils literal notranslate"><span class="pre">math.sqrt(2)/2</span></code> or <code class="docutils literal notranslate"><span class="pre">np.sqrt(2)/2</span></code> (here <code class="docutils literal notranslate"><span class="pre">np</span></code> stands for <code class="docutils literal notranslate"><span class="pre">numpy</span></code>).</p>
</section>
<section id="tvar">
<h3>.tvar<a class="headerlink" href="#tvar" title="Permalink to this heading">¶</a></h3>
<p>Types of variables can resemble to</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Id      Comment Name    Kind    Type    Value
                upt     NET     F       <span class="m">1</span>.02369
                emp1    NET     F       <span class="m">0</span>.511098
                emp2    NET     D
                ppp2    XCH     F       <span class="m">0</span>.778786
                ppp3    XCH     C       <span class="m">0</span>.83932
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">Type</span></code> can be either</p>
<blockquote>
<div><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">F</span></code></dt><dd><p>for “free”, requires a float number in <code class="docutils literal notranslate"><span class="pre">Value</span></code></p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">D</span></code></dt><dd><p>for “dependent” or</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">C</span></code></dt><dd><p>for “constrained”, requires a float number in <code class="docutils literal notranslate"><span class="pre">Value</span></code>.</p>
</dd>
</dl>
</div></blockquote>
<p>The <code class="docutils literal notranslate"><span class="pre">Kind</span></code> can be either</p>
<blockquote>
<div><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">NET</span></code></dt><dd><p>for net fluxes</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">XCH</span></code></dt><dd><p>for exchange fluxes</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">METAB</span></code></dt><dd><p>for specie concentration</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="opt">
<h3>.opt<a class="headerlink" href="#opt" title="Permalink to this heading">¶</a></h3>
<p>Options passed to <code class="docutils literal notranslate"><span class="pre">influx_si</span></code> can be similar to:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Id      Comment Name                    Value
                dt                      <span class="m">1</span>
                nsubdiv_dt              <span class="m">4</span>
                file_labcin             e_coli_msen.txt
                commandArgs             --noscale --TIMEIT --time_order<span class="o">=</span><span class="m">2</span> --zc<span class="o">=</span><span class="m">0</span> --clowp <span class="m">1</span>.e-9
                optctrl:nlsic:errx      <span class="m">1</span>.e-3
                optctrl:nlsic:maxit     <span class="m">50</span>
                optctrl:nlsic:btmaxit   <span class="m">16</span>
                optctrl:nlsic:btstart   <span class="m">1</span>
                optctrl:nlsic:btfrac    <span class="m">0</span>.5
                optctrl:nlsic:adaptbt   <span class="m">1</span>
                optctrl:nlsic:monotone  <span class="m">1</span>
                posttreat_R             plot_ilab.R
</pre></div>
</div>
<p>The meaning of each possible option is described in different sections of this manual.</p>
</section>
<section id="vmtf">
<h3>.vmtf<a class="headerlink" href="#vmtf" title="Permalink to this heading">¶</a></h3>
<p>Variable part of MTF approach can be used to combine constant and variable
parts of experiments to launch a calculation of flux maps in a batch.
E.g. in a set of experiments on the same organism in different biological conditions, <code class="docutils literal notranslate"><span class="pre">.miso</span></code>, <code class="docutils literal notranslate"><span class="pre">.mflux</span></code> can vary from one experiment to another while <code class="docutils literal notranslate"><span class="pre">.netw</span></code> and other files can remain the same in the whole experiment set.
In this case, files containing variable sections (here <code class="docutils literal notranslate"><span class="pre">.miso</span></code> and <code class="docutils literal notranslate"><span class="pre">.mflux</span></code>)
can be given in a special file having an extension ‘.vmtf’ while constant
parts will be given in <code class="docutils literal notranslate"><span class="pre">--mtf</span></code> or <code class="docutils literal notranslate"><span class="pre">--prefix</span></code> options.</p>
<p><code class="docutils literal notranslate"><span class="pre">.vmtf</span></code> file is a TSV file with
columns using the same name as extensions described above: <code class="docutils literal notranslate"><span class="pre">netw</span></code>, <code class="docutils literal notranslate"><span class="pre">linp</span></code>, etc.
Each row contains file names that will be used to produce a particular
FTBL file used in calculation.
Thus, each row must have <code class="docutils literal notranslate"><span class="pre">ftbl</span></code> column with unique and non empty name. If a file
type is present both in column names of ‘vmtf’ and in <code class="docutils literal notranslate"><span class="pre">--mtf</span></code>/<code class="docutils literal notranslate"><span class="pre">--prefix</span></code> option
then the content of ‘vmtf’ file will take precedence. Empty values
in <code class="docutils literal notranslate"><span class="pre">vmtf</span></code> file are ignored. All file paths in <code class="docutils literal notranslate"><span class="pre">vmtf</span></code> file are
considered relative to the location of <code class="docutils literal notranslate"><span class="pre">vmtf</span></code> file itself. If in <code class="docutils literal notranslate"><span class="pre">.vmtf</span></code>,
a file name is given without extension, it is deduced from column name. Example of <code class="docutils literal notranslate"><span class="pre">.vmtf</span> <span class="pre">file</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Id      Comment miso            mflux           tvar            ftbl
                model_WT_BW_1   model_WT_BW_1   model_WT_BW_1   vmtf_WT_BW_1
                model_WT_BW_2   model_WT_BW_2   model_WT_BW_2   vmtf_WT_BW_2
                model_zwf_1     model_zwf_1     model_zwf_1     vmtf_zwf_1
</pre></div>
</div>
<p>Example of command line using <code class="docutils literal notranslate"><span class="pre">.vmtf</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>--prefix ecoli --mtf variable.vmtf
</pre></div>
</div>
</section>
</section>
<section id="output-format">
<h2>Output format<a class="headerlink" href="#output-format" title="Permalink to this heading">¶</a></h2>
<p>Since v7.0, MTF is also used as output format for most result files. However, compared to input files, some additional columns were added. We will describe them in appropriate subsections.</p>
<p>The whole set of output files go to <code class="docutils literal notranslate"><span class="pre">mynetwork_res</span></code> directory if this name is not overwritten with <code class="docutils literal notranslate"><span class="pre">--out</span></code> option. Here <code class="docutils literal notranslate"><span class="pre">mynetwork</span></code> is just a name example to be adapted to your situation. Let review output files.
By default, the result subdirectory is located in the same directory as input MTF files.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All result files are silently overwritten if already exist.
So take care to copy your results elsewhere if you want to protect them from overwriting.</p>
</div>
<section id="mynetwork-log">
<h3><code class="docutils literal notranslate"><span class="pre">mynetwork.log</span></code><a class="headerlink" href="#mynetwork-log" title="Permalink to this heading">¶</a></h3>
<p>contains the run-time log messages, in particular,
it contains a report on convergence history during the fitting process.
It can be helpful for identifying potential problems. Some warnings can be written in this file, so user should scrutinize this file for lines starting with <code class="docutils literal notranslate"><span class="pre">***Warning:</span></code> to be informed about potential issues.</p>
<p>For example, a warning about structurally non identifiable fluxes can look like:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>***Warning: inverse of covariance matrix is numerically singular.
Statistically undefined parameter(s) seems to be:
f.x.pyk
For a more complete list, see SD column in &#39;.tvar.sim&#39; result file.
</pre></div>
</div>
</section>
<section id="mynetwork-err">
<h3><code class="docutils literal notranslate"><span class="pre">mynetwork.err</span></code><a class="headerlink" href="#mynetwork-err" title="Permalink to this heading">¶</a></h3>
<p>This file contains critical error messages preventing from normal program execution. Normally, it should be empty (0 byte size). If it is not, there is something definitely wrong either in the input files or with the program itself that should be fixed before going on.</p>
<p>Problems can appear in all stages of a software run:</p>
<ul>
<li><p>parsing MTF/FTBL files</p></li>
<li><p>R code writing</p></li>
<li><p>R code execution</p>
<blockquote>
<div><ul class="simple">
<li><p>vector-matrix initialization</p></li>
<li><p>optimization</p></li>
<li><p>post-optimization treatment</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<p>Most of the error messages are automatically generated by underlying languages Python and R. These messages can appear somewhat cryptic for a user unfamiliar with these languages. But the most critical error messages are edited to be as explicit as possible. For example, a message about badly structurally defined network could be similar to</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Error : Provided measurements (isotopomers and fluxes) are not
        sufficient to resolve all free fluxes.
Unsolvable fluxes may be:
        f.x.tk2, f.n.Xylupt_1, f.x.maldh, f.x.pfk, f.x.ta, f.x.tk1
Jacobian dr_dff is dumped in dbg_dr_dff_singular.txt
</pre></div>
</div>
<p>a message about singular cumomer balance matrix could resemble to</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>lab_sim: Cumomer matrix is singular. Try &#39;--clownr N&#39; or/and &#39;--zc N&#39; options with small N, say 1.e-3 or constrain some of the fluxes listed below to be non zero Zero rows in cumomer matrix A at weight 1:
cit_c:16
ac_c:2
...
Zero fluxes are:
fwd.ACITL
...
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<blockquote>
<div><p>In this error message, we report cumomers whose balance gave a zero row in the cumomer matrix (here <code class="docutils literal notranslate"><span class="pre">cit_c:&lt;N&gt;</span></code> cumomers, where &lt;N&gt; is an integer, its binary mask indicates the “1”s in the cumomer definition) as well as a list of fluxes having 0 value. This information could help a user to get insight about a flux whose zero value led to a singular matrix. A workaround for such situation could be setting in the <code class="docutils literal notranslate"><span class="pre">.cnstr</span></code> file an inequality constraining a faulty flux to keep a small non zero value. A more radical workaround could be restricting some flux classes (input-output  fluxes with the option <code class="docutils literal notranslate"><span class="pre">--cinout=CINOUT</span></code> or even all non-reversible ones with the option <code class="docutils literal notranslate"><span class="pre">--clownr=CLOWNR</span></code>) to stay out of 0, e.g.:</p>
</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">influx_s.py</span> <span class="pre">--clownr</span> <span class="pre">0.0001</span> <span class="pre">--prefix</span> <span class="pre">mynetwork</span></code></p>
<p>Adding such inequalities does not guaranty that cumomer matrix will become invertible, but often it does help.
It’s up to the user to check that an addition of such inequalities does not contradict biological sens of his network.</p>
</div>
<p>and so on.</p>
<p>A user should examine carefully any warning/error message and start to fix the problems by the first one in the list (if there are many) and not by the easiest or the most obvious to resolve. After fixing the first problem, rerun <code class="docutils literal notranslate"><span class="pre">influx_si</span></code> to see if other problems are still here. Sometimes, an issue can induce several others. So, fixing the first issue could eliminate some others. Repeat this process, till all the troubles are eliminated.</p>
</section>
<section id="mynetwork-miso-sim-mynetwork-mflux-sim-mynetwork-mmet-sim">
<h3><code class="docutils literal notranslate"><span class="pre">mynetwork.miso.sim</span></code>, <code class="docutils literal notranslate"><span class="pre">mynetwork.mflux.sim</span></code>, <code class="docutils literal notranslate"><span class="pre">mynetwork.mmet.sim</span></code><a class="headerlink" href="#mynetwork-miso-sim-mynetwork-mflux-sim-mynetwork-mmet-sim" title="Permalink to this heading">¶</a></h3>
<p>These files contain simulated values and are formatted as input files for isotopic, flux and concentration measurements. Additional columns are:</p>
<blockquote>
<div><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">Residual</span></code></dt><dd><p>containing reduced residual values calculated as “(simulated - measured)/SD”;</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Pvalue</span></code></dt><dd><p>result of Z-test on residual value. Lower p-value corresponds to higher (in absolute value) residual.</p>
</dd>
</dl>
</div></blockquote>
<p>If multiple starting points were used (e.g. with <code class="docutils literal notranslate"><span class="pre">--fseries</span></code> and/or <code class="docutils literal notranslate"><span class="pre">--iseries</span></code> options) then result corresponding to each starting point will be numbered with prefix <code class="docutils literal notranslate"><span class="pre">.V</span></code>, e.g. <code class="docutils literal notranslate"><span class="pre">mynetwork.V10.miso.sim</span></code> for tenth staring point.</p>
</section>
<section id="mynetwork-tvar-sim">
<h3><code class="docutils literal notranslate"><span class="pre">mynetwork.tvar.sim</span></code><a class="headerlink" href="#mynetwork-tvar-sim" title="Permalink to this heading">¶</a></h3>
<p>Estimated fluxes and specie concentrations (if any) are all gathered in this file, in column <code class="docutils literal notranslate"><span class="pre">Value</span></code>. Additional columns are:</p>
<blockquote>
<div><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">SD</span></code></dt><dd><p>Estimated Standard Deviation</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Struct_identif</span></code></dt><dd><p>Contains “yes” if the value on the current row is considered as structurally identifiable (“no” otherwise). We arbitrary set a threshold for “yes” decision at SD &lt;= 10000. Note that a value can be structurally identifiable but still statistically poorly defined.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Low_mc</span></code>, <code class="docutils literal notranslate"><span class="pre">Up_mc</span></code></dt><dd><p>If Monte-Carlo method for sensitivity estimation is used (cf. option <code class="docutils literal notranslate"><span class="pre">--sens</span> <span class="pre">mc=MC</span></code>) then these columns contain lower and upper 95% confidence interval limits. They are estimated at quantile levels 2.5% and 97.5% respectively.</p>
</dd>
</dl>
</div></blockquote>
<p>In case of multiple starting points, this file is numbered.</p>
</section>
<section id="mynetwork-stat">
<h3><code class="docutils literal notranslate"><span class="pre">mynetwork.stat</span></code><a class="headerlink" href="#mynetwork-stat" title="Permalink to this heading">¶</a></h3>
<p>This file contains results of chi2 statistical test. Its content can look like:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>chi2_value              61.5141593189625
chi2/df                 1.86406543390795
number_of_measurements  54
number_of_parameters    21
degrees_of_freedom      33
p-value                 0.998130284339227
conclusion              At level of 95% confidence, the model does not fit the data good enough with respect to the provided measurement SD
</pre></div>
</div>
<p>The field names are self explanatory. In case of multiple starting points, this file is numbered.</p>
</section>
<section id="custom-files">
<h3>Custom files<a class="headerlink" href="#custom-files" title="Permalink to this heading">¶</a></h3>
<p>These files (e.g. <code class="docutils literal notranslate"><span class="pre">mynetwork.pdf</span></code>) can be produced by user supplied scripts that are executed at the end of <code class="docutils literal notranslate"><span class="pre">influx_si</span></code> simulations. For example, we provide a script <code class="docutils literal notranslate"><span class="pre">plot_ilab.R</span></code> which can be used to plot label kinetics simulated by <code class="docutils literal notranslate"><span class="pre">influx_i</span></code> or <code class="docutils literal notranslate"><span class="pre">plot_smeas.R</span></code> for <code class="docutils literal notranslate"><span class="pre">influx_s</span></code>. One or many of such custom scripts can be given in .opt file, field <code class="docutils literal notranslate"><span class="pre">posttreat_R</span></code> (cf. e_coli_i.opt for example)</p>
</section>
<section id="old-result-files">
<h3>Old result files<a class="headerlink" href="#old-result-files" title="Permalink to this heading">¶</a></h3>
<p>For users willing to continue usage of old result files, namely <code class="docutils literal notranslate"><span class="pre">mynetwork_res.kvh</span></code>, we kept them in <code class="docutils literal notranslate"><span class="pre">tmp</span></code> subdirectory.</p>
<p>Thus typically, a <code class="docutils literal notranslate"><span class="pre">tmp</span></code> subdir contains:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">mynetwork.ftbl</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mynetwork.pres.csv</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mynetwork.R</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mynetwork_res.kvh</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">edge.netflux.mynetwork.attrs</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">edge.xchflux.mynetwork.attrs</span></code></p></li>
</ul>
</div></blockquote>
</section>
</section>
<section id="basic-influx-si-usage">
<h2>Basic influx_si usage<a class="headerlink" href="#basic-influx-si-usage" title="Permalink to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">influx_si</span></code> can be run as</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ influx_s.py --prefix mynetwork
</pre></div>
</div>
<p>or</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ influx_i.py --prefix mynetwork
</pre></div>
</div>
<p>Letters <code class="docutils literal notranslate"><span class="pre">s</span></code> and <code class="docutils literal notranslate"><span class="pre">i</span></code> stand for “stationary” and “instationary”.
We suppose here that a valid MTF file set was created. Moreover, we supposed <code class="docutils literal notranslate"><span class="pre">influx_s.py</span></code> and <code class="docutils literal notranslate"><span class="pre">influx_i.py</span></code> are in the PATH variable.</p>
<p>In the rest of this manual, we’ll use just <code class="docutils literal notranslate"><span class="pre">influx_s.py</span></code> as an example if the example is valid for both stationary and instationary contexts. If some usage is valid exclusively for <code class="docutils literal notranslate"><span class="pre">influx_i.py</span></code>, it will be duly signaled.</p>
<p>In a high throughput context, it can be useful to proceed many MTF set files in parallel. This can be done by giving all variable parts of experiment set in a <code class="docutils literal notranslate"><span class="pre">.vmtf</span></code> file, e.g.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ influx_s.py --prefix mynetwork --mtf variable.vmtf
</pre></div>
</div>
<p>All files are then proceeded in separate independent processes launched almost simultaneously by a bunch of size equal to the number of available or requested cores (if an option <code class="docutils literal notranslate"><span class="pre">--np=NP</span></code> is used). It is an operating system who is in charge to make a distribution of all these processes among all available CPUs and cores.</p>
<p>Sometimes, particular cases need usage of special options of <code class="docutils literal notranslate"><span class="pre">influx_si</span></code>. The list of available options can be seen by running:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ influx_s.py --help
</pre></div>
</div>
<p>If used with options, <code class="docutils literal notranslate"><span class="pre">influx_si</span></code> can be run like</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ influx_s.py <span class="o">[</span>options<span class="o">]</span> --prefix mynetwork
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">[options]</span></code> is an option list separated by a white character.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Here and throughout this manual, content placed in brackets  <code class="docutils literal notranslate"><span class="pre">[...]</span></code> is meant to be an optional part of the command. If the user does wish to type an optional part of a command, the brackets themselves must be omitted.</p>
</div>
<p>Each option starts with a double dash <code class="docutils literal notranslate"><span class="pre">--</span></code> and can be followed by its argument if applicable. For example, to use BFGS optimization method instead of the default NLSIC algorithm, a user can run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ influx_s.py --meth BFGS --prefix mynetwork
</pre></div>
</div>
<p>or</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ influx_s.py --meth<span class="o">=</span>BFGS --prefix mynetwork
</pre></div>
</div>
<p>The option names can be shortened till a non-ambiguous interpretation is possible, e.g., in the previous example, the option could be shortened as <code class="docutils literal notranslate"><span class="pre">--me</span> <span class="pre">BFGS</span></code> or <code class="docutils literal notranslate"><span class="pre">--me=BFGS</span></code> because there is no other option name starting by <code class="docutils literal notranslate"><span class="pre">me</span></code>. But an option <code class="docutils literal notranslate"><span class="pre">--no</span></code> could not be distinguished between <code class="docutils literal notranslate"><span class="pre">--noopt</span></code> and <code class="docutils literal notranslate"><span class="pre">--noscale</span></code>. So at least <code class="docutils literal notranslate"><span class="pre">--nos</span></code> (for <code class="docutils literal notranslate"><span class="pre">--noscale</span></code>) or <code class="docutils literal notranslate"><span class="pre">--noo</span></code> (for <code class="docutils literal notranslate"><span class="pre">--noopt</span></code>) should be provided. There is only one option that does not admit a usage of an equal sign to provide an argument, it is <code class="docutils literal notranslate"><span class="pre">--excl_outliers</span></code>. Use only a space character to provide an argument to this option when required.</p>
<p>Here after, the available options with their full names are enumerated and detailed.</p>
<section id="influx-si-command-line-options">
<h3><code class="docutils literal notranslate"><span class="pre">influx_si</span></code> command line options<a class="headerlink" href="#influx-si-command-line-options" title="Permalink to this heading">¶</a></h3>
<blockquote>
<div><dl class="option-list">
<dt><kbd><span class="option">--version</span></kbd></dt>
<dd><p>show program’s version number and exit</p>
</dd>
<dt><kbd><span class="option">-h</span>, <span class="option">--help</span></kbd></dt>
<dd><p>show the help message and exit</p>
</dd>
<dt><kbd><span class="option">--noopt</span></kbd></dt>
<dd><p>no optimization, just use free fluxes as is (after a projection on feasibility domain), to calculate
dependent fluxes, cumomers, stats and so on</p>
</dd>
<dt><kbd><span class="option">--noscale</span></kbd></dt>
<dd><p>no scaling factors to optimize =&gt; all scaling factors are assumed to be 1</p>
<p>This option can be useful if your measurements are already scaled to sum up to 1 which is often the case of MS data. Then, user saves some free parameters corresponding to scaling factors. This option can become mandatory if user wants to prevent scaling factors to be adjusted by optimization process.</p>
</dd>
<dt><kbd><span class="option">--meth=<var>METH</var></span></kbd></dt>
<dd><p>method for optimization, one of <code class="docutils literal notranslate"><span class="pre">nlsic|BFGS|Nelder-Mead|pso</span></code>.
Default: <code class="docutils literal notranslate"><span class="pre">nlsic</span></code>. Multiple occurrences of this
option can appear on command line. In this case,
specified minimization methods are applied successively,
e.g. <code class="docutils literal notranslate"><span class="pre">--meth</span> <span class="pre">pso</span> <span class="pre">--meth</span> <span class="pre">nlsic</span></code> means that <code class="docutils literal notranslate"><span class="pre">pso</span></code> will be
used first, then <code class="docutils literal notranslate"><span class="pre">nlsic</span></code> will take over from the point
where <code class="docutils literal notranslate"><span class="pre">pso</span></code> ends. In case of multiple methods, it is
recommended starting with non-gradient methods like <code class="docutils literal notranslate"><span class="pre">pso</span></code>
or <code class="docutils literal notranslate"><span class="pre">Nelder-Mead</span></code> and make them follow by gradient based
methods like <code class="docutils literal notranslate"><span class="pre">nlsic</span></code> or <code class="docutils literal notranslate"><span class="pre">BFGS</span></code>. If <code class="docutils literal notranslate"><span class="pre">pso</span></code> or <code class="docutils literal notranslate"><span class="pre">Nelder-Mead</span></code>
are indeed used as the first method, it is not
recommended combining them with <code class="docutils literal notranslate"><span class="pre">--zc</span></code> option.</p>
</dd>
<dt><kbd><span class="option">--fullsys</span></kbd></dt>
<dd><p>calculate all cumomer set (not just the reduced one
necessary to simulate measurements)</p>
<p>This option influences only post-optimization treatment. The fitting itself is still done with the reduced cumomer set or EMU variables if requested so. See the original paper on <code class="docutils literal notranslate"><span class="pre">influx_s</span></code> for more information on the reduced cumomer set.</p>
</dd>
<dt><kbd><span class="option">--emu</span></kbd></dt>
<dd><p>simulate labeling in EMU approach</p>
<p>This option should not produce a different result in parameter fitting. It is implemented and provided in a hope that on some network the results can be obtained in a shorter time</p>
</dd>
<dt><kbd><span class="option">--irand</span></kbd></dt>
<dd><p>ignore initial approximation for free parameters (free fluxes and specie concentrations) from the FTBL file or from a dedicated file (cf –fseries and –iseries
option) and use random values drawn uniformly from [0,1]</p>
<p>It is recommended to use this option in conjunction with “–zc 0” option.</p>
</dd>
<dt><kbd><span class="option">--sens=<var>SENS</var></span></kbd></dt>
<dd><p>sensitivity method: SENS can be ‘mc[=N]’, mc stands for
Monte-Carlo. N is the number of Monte-Carlo simulations.
Default for N: 10</p>
<p>The sensitivity information (i.e., the influence of the noise in the data on the estimated parameter variation) based on linearized statistics is always provided. So the user has to use this option only if he wants to compare this linearized information to the Monte-Carlo simulations. Note that the default value 10 for the number of simulations is far from to be sufficient to get reliable statistical estimations. This default option allows only to quickly check that this option is working as expected.</p>
</dd>
<dt><kbd><span class="option">--cupx=<var>CUPX</var></span></kbd></dt>
<dd><p>upper limit for reverse fluxes. Must be in interval [0, 1]. Default: 0.999</p>
</dd>
<dt><kbd><span class="option">--cupn=<var>CUPN</var></span></kbd></dt>
<dd><p>upper limit for net fluxes. Default: 1.e3</p>
</dd>
<dt><kbd><span class="option">--cupp=<var>CUPP</var></span></kbd></dt>
<dd><p>upper limit for specie pool. Default: 1.e5</p>
</dd>
<dt><kbd><span class="option">--clownr=<var>CLOWNR</var></span></kbd></dt>
<dd><p>lower limit for not reversible free and dependent fluxes.
Zero value (default) means no lower limit</p>
<p>A byproduct of this option is that it can drastically reduce  cumomer system sizes. As it ensures that non-reversible fluxes cannot change the sign, revers fluxes can be eliminated from pathways leading to observable cumomers.</p>
</dd>
<dt><kbd><span class="option">--cinout=<var>CINOUT</var></span></kbd></dt>
<dd><p>lower limit for input/output free and dependent fluxes.
Must be non-negative. Default: 0</p>
</dd>
<dt><kbd><span class="option">--clowp=<var>CLOWP</var></span></kbd></dt>
<dd><p>lower limit for free specie pools. Must be positive. Default 1.e-8</p>
</dd>
<dt><kbd><span class="option">--np=<var>NP</var></span></kbd></dt>
<dd><p>When integer &gt;= 1, it is a number of parallel threads (on
Unix) or subprocesses (on Windows) used in Monte-Carlo
(M-C) simulations or for multiple FTBL inputs. When NP is
a float number between 0 and 1, it gives a fraction of
available cores (rounded to closest integer) to be used.
Without this option or for NP=0, all available cores in a
given node are used for M-C simulations.</p>
</dd>
<dt><kbd><span class="option">--ln</span></kbd></dt>
<dd><p>Least norm solution is used for increments during the non-linear iterations when Jacobian is rank deficient</p>
<p>Jacobian can become rank deficient if provided data are not sufficient to resolve all free fluxes. It can be useful to determine fluxes that can still be resolved by the available measurements. If the Jacobian does not become rank deficient, this option has no influence on the found solution, neither on the optimization process. But if the Jacobian does become rank deficient, a warning message is printed in the error file even if the optimization process could go to the end.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Use this option with caution, in particular, when used in conjunction with Monte-Carlo simulations. As undetermined fluxes will be given some particular value, this value can be more or less stable from one Monte-Carlo simulation to another. This can create an illusion that a flux is well determined. See the linearized statistics in the result file to decide which fluxes are badly resolved.</p>
</div>
<p>A correct way to deal with badly defined metabolic network is to provide additional data that can help to resolve all the fluxes and/or to optimize input label, not just put <code class="docutils literal notranslate"><span class="pre">--ln</span></code> option and cross the fingers.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>In this option, the notion of “least norm” is applied to <em>increments</em> during the optimization, not to the final solution. So undetermined fluxes could vary from one run to another if the optimization process is started from different points, while well determined fluxes should keep stable values.</p>
</div>
</dd>
<dt><kbd><span class="option">--sln</span></kbd></dt>
<dd><p>Least norm of the solution of linearized problem (and not just of increments) is used when Jacobian is rank deficient</p>
</dd>
<dt><kbd><span class="option">--tikhreg</span></kbd></dt>
<dd><p>Approximate least norm solution is used for increments
during the non-linear iterations when Jacobian is rank
deficient</p>
<p>To obtain an approximate solution, a Tikhonov regularization is used when solving an LSI problem. Only one of the options <code class="docutils literal notranslate"><span class="pre">--ln</span></code> and <code class="docutils literal notranslate"><span class="pre">--tikhreg</span></code> can be activated in a given run.</p>
</dd>
<dt><kbd><span class="option">--lim</span></kbd></dt>
<dd><p>The same as –ln but with a function limSolve::lsei()</p>
</dd>
<dt><kbd><span class="option">--zc=<var>ZC</var></span></kbd></dt>
<dd><p>Apply zero crossing strategy with non-negative threshold
for net fluxes</p>
<p>This option can accelerate convergence in situations when a net flux has to change its sign during the optimization iterations. Once such flux is identified, it is better to write the corresponding reaction in opposite sens in the FTBL file or to give a starting value with a correct sign to avoid such zero crossing situation.</p>
</dd>
<dt><kbd><span class="option">--ffguess</span></kbd></dt>
<dd><p>Don’t use free/dependent flux definitions from FTBL
file(s). Make an automatic guess.</p>
<p>The fact that free fluxes are chosen automatically does not allow specifying a starting point for optimization iterations so a random starting point is used (drawn uniformly in [0; 1] interval). An option <code class="docutils literal notranslate"><span class="pre">--seed</span></code> can be useful to make the results reproducible.</p>
</dd>
<dt><kbd><span class="option">--fseries=<var>FSERIES</var></span></kbd></dt>
<dd><p>File name with free parameter values for multiple
starting points. Default: ‘’ (empty, i.e. only one
starting point from the FTBL file is used)</p>
<p>The file must be formatted as plain text file with tab separator. There must be as many columns as starting points and at least as many rows as free parameters assigned in this file. A subset of free parameters can be used in this file. In this case, the rest of parameters take their unique starting values from the FTBL file. The first column must contain the names of free parameters used in this file. If there are extra rows whose names are not in the set of free parameter names, they are simply ignored. The first row must contain the names of starting points. These names can be just numbers from 1 to the number of starting points.</p>
</dd>
<dt><kbd><span class="option">--iseries=<var>ISERIES</var></span></kbd></dt>
<dd><p>Indexes of starting points to use. Format: ‘1:10’ – use only first ten starting points; ‘1,3’ – use the first and third starting points; ‘1:10,15,91:100’ – a mix of both formats is allowed. Default ‘’ (empty, i.e. all provided starting points are used)</p>
<p>When used with conjunction with <code class="docutils literal notranslate"><span class="pre">--fseries</span></code>, this option indicates the starting points to use from FSERIES file. But this option can also be used in conjunction with <code class="docutils literal notranslate"><span class="pre">--irand</span></code> to generate a required number of random starting points, e.g., <code class="docutils literal notranslate"><span class="pre">influx_s.py</span> <span class="pre">--irand</span> <span class="pre">--iseries</span> <span class="pre">1:10</span> <span class="pre">mynetwork</span></code> will generate and use 10 random starting points.</p>
<p>For both <code class="docutils literal notranslate"><span class="pre">--fseries</span></code> and <code class="docutils literal notranslate"><span class="pre">--iseries</span></code>, one result file is generated per starting point, e.g., <code class="docutils literal notranslate"><span class="pre">mynetwork_res.V1.kvh</span></code>, <code class="docutils literal notranslate"><span class="pre">mynetwork_res.V2.kvh</span></code> and so on. If starting points comes from a <code class="docutils literal notranslate"><span class="pre">--fseries</span></code> then the suffixes <code class="docutils literal notranslate"><span class="pre">V1</span></code>, <code class="docutils literal notranslate"><span class="pre">V2</span></code>, … are replaced by the column names from this file. In addition, a file <code class="docutils literal notranslate"><span class="pre">mynetwork.pres.csv</span></code> resuming all estimated parameters and final cost values is written.</p>
</dd>
<dt><kbd><span class="option">--seed=<var>SEED</var></span></kbd></dt>
<dd><p>Integer (preferably a prime integer) used for
reproducible random number generating. It makes
reproducible random starting points (–irand) but also
Monte-Carlo simulations for sensitivity analysis.
Default: none, i.e., current system value is used, so
random drawing will be varying at each run.</p>
</dd>
<dt><kbd><span class="option">--excl_outliers</span></kbd></dt>
<dd><p>This option takes an optional argument, a p-value between
0 and 1 which is used to filter out measurement outliers.
The filtering is based on Z statistics calculated on
reduced residual distribution. Default: 0.01.</p>
<p>Excluded outliers (if any) and their residual values are reported in the <code class="docutils literal notranslate"><span class="pre">mytework.log</span></code> file. Non-available (<code class="docutils literal notranslate"><span class="pre">NA</span></code>) measurements are considered as outliers for any p-value.
An optional p-value used here does not give a proportion of residuals that will be excluded from the optimization process, but rather a degree of being a valuable measurement. So, closer to zero is the p-value, the fewer data are filtered out. If in contrary, you want to filter out more outliers than with the default p-value, use a value grater than the default value of 0.01, e.g.:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>influx_s.py --excl_outliers <span class="m">0</span>.02 mynetwork.ftbl
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Don’t use an equal sign “=” to give a p-value to this option. Here, only a white space can be used as a separator (as in the example above).</p>
</div>
</dd>
<dt><kbd><span class="option">--nocalc</span></kbd></dt>
<dd><p>generate an R code but not execute it.</p>
<p>This option can be useful for parallel execution of the generated R files via <code class="docutils literal notranslate"><span class="pre">source()</span></code> function in cluster environment</p>
</dd>
<dt><kbd><span class="option">--addnoise</span></kbd></dt>
<dd><p>Add centered gaussian noise to simulated measurements written to _res.kvh file. SD of this noise is taken from FTBL file</p>
<p>This option can be helpful for generating synthetic FTBL files with realistic simulated measurements (cf. <a class="reference internal" href="howto.html#howto"><span class="std std-ref">How to make FTBL file with synthetic data?</span></a>).</p>
</dd>
<dt><kbd><span class="option">--mtf <var>MTF</var></span></kbd></dt>
<dd><p>option passed to txt2ftbl. See help there.</p>
</dd>
<dt><kbd><span class="option">--prefix <var>PREFIX</var></span></kbd></dt>
<dd><p>option passed to txt2ftbl. See help there.</p>
</dd>
<dt><kbd><span class="option">--eprl <var>EPRL</var></span></kbd></dt>
<dd><p>option passed to txt2ftbl. See help there.</p>
</dd>
<dt><kbd><span class="option">--force <var>FORCE</var></span></kbd></dt>
<dd><p>option passed to txt2ftbl. See help there.</p>
</dd>
<dt><kbd><span class="option">-o <var>OUT</var></span>, <span class="option">--out <var>OUT</var></span></kbd></dt>
<dd><p>output directory. Default: basename of input file without suffix + ‘_res’. If empty, no output directory is created. In this case log and error messages are directed to standard output/error channels. Non empty OUT can be used when only one input file or MTF set is given.</p>
</dd>
<dt><kbd><span class="option">--copy_doc</span></kbd></dt>
<dd><p>copy documentation directory in the current directory and
exit. If ./doc exists, its content is silently overwritten.</p>
</dd>
<dt><kbd><span class="option">--copy_test</span></kbd></dt>
<dd><p>copy test directory in the current directory and exit. If
./test exists, its content is silently owerriten.</p>
</dd>
<dt><kbd><span class="option">--install_rdep</span></kbd></dt>
<dd><p>install R dependencies and exit.</p>
<p>starting from v5.3, this installation is made in interactive mode. I.e. if the default installation directory (the first one from a list returned by R’s <code class="docutils literal notranslate"><span class="pre">.libPaths()</span></code>) is not writable by the user then <code class="docutils literal notranslate"><span class="pre">influx_si</span></code> will try to install the needed packages in the directory defined in R session variable <code class="docutils literal notranslate"><span class="pre">R_LIBS_USER</span></code>. If this last does not exist, the user is asked for a permission to create it. This behavior is the default one of R’s <code class="docutils literal notranslate"><span class="pre">install.packages()</span></code> which is used here.</p>
</dd>
<dt><kbd><span class="option">--TIMEIT</span></kbd></dt>
<dd><p>developer option</p>
<p>Some portions of code are timed, and the results is printed in the log-file. A curious user can use this option without any harm.</p>
</dd>
<dt><kbd><span class="option">--prof</span></kbd></dt>
<dd><p>developer option</p>
<p>This option provides much more detailed profiling of the execution than <code class="docutils literal notranslate"><span class="pre">--TIMEIT</span></code> option. Only developers can be interested in using such information.</p>
</dd>
</dl>
</div></blockquote>
<p>All command line options can also be provided in a .opt file. A user can put them in the field <code class="docutils literal notranslate"><span class="pre">commandArgs</span></code>, e.g.</p>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Name            Value
commandArgs     --meth BFGS --sens mc=100 --np 1
</pre></div>
</div>
</div></blockquote>
<p>If an option is provided both on the command line and in the .opt file, it is the command line that has the priority. In such a way, a user is given an opportunity to overwrite any option at the run time. Nevertheless, there is no way to cancel a flag option (an option without argument) on a command line if it is already set in the .opt file. For example, if <code class="docutils literal notranslate"><span class="pre">--fullsys</span></code> flag is set in the .opt file, the full system information will be produced whatever command line options are.</p>
</section>
</section>
<section id="parallel-experiments">
<h2>Parallel experiments<a class="headerlink" href="#parallel-experiments" title="Permalink to this heading">¶</a></h2>
<p id="prlexp">Staring from v4.0, <code class="docutils literal notranslate"><span class="pre">influx_si</span></code> offers possibility to treat labeling  data from parallel experiments. Parallel experiments for stationary labeling were described in the literature (e.g. cf. “Parallel labeling experiments and metabolic flux analysis: Past, present and future methodologies.”, Crown SB, Antoniewicz MR., <em>Metab Eng.</em> 2013 Mar;16:21-32. doi: 10.1016/j.ymben.2012.11.010). But for instationary labeling, at the best of our knowledge, <code class="docutils literal notranslate"><span class="pre">influx_si</span></code> is the first software offering parallel experiments treatment.</p>
<p>The main interest of parallel experiments is increased precision of flux estimations. This comes at a price of additional work for experiments and data gathering, but the result is often worth the effort. As usual, before doing a real “wet” experiment, it can be useful to run a few  “dry” simulations to see if planned experiments will deliver desired precision.</p>
<p>To deal with parallel experiments, a user have to prepare a series of additional .miso/.linp couples, one per additional experiment. While the “main” .miso/.linp couple can be given in <code class="docutils literal notranslate"><span class="pre">--prefix</span></code> or <code class="docutils literal notranslate"><span class="pre">--mtf</span></code> options.</p>
<p>Each couple provides input labeling and measured labeling data corresponding to an experiment.
This file architecture ensures that a network topology, flux, and specie values are common to all experiments, while entry label and measurements on labeled species are proper to each experiment.</p>
<p>When files are ready, you can run <code class="docutils literal notranslate"><span class="pre">influx_si</span></code> on them, e.g. in <code class="docutils literal notranslate"><span class="pre">test/prl_exp/mtf</span></code> directory run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ influx_s.py --pref e_coli_glc1-6n --eprl e_coli_glc2n,e_coli_glc3n,e_coli_glc4n,e_coli_glc5n,e_coli_glc6n
</pre></div>
</div>
<p>In this example, 6 parallel experiments were used, the “main” being described in files ecoli_glc1-6n and 5 additional ones in files going from <code class="docutils literal notranslate"><span class="pre">e_coli_glc2n</span></code> to <code class="docutils literal notranslate"><span class="pre">e_coli_glc6n</span></code>. Note that we used a compact form of <code class="docutils literal notranslate"><span class="pre">--eprl</span></code> options as all .miso/.linp couples used canonical suffixes. In that way, giving only a prefix like <code class="docutils literal notranslate"><span class="pre">e_coli_glc2n</span></code> was sufficient to find the both corresponding files.</p>
<p>The command can be shortened even more if <code class="docutils literal notranslate"><span class="pre">prl_exp</span></code> option is used in <code class="docutils literal notranslate"><span class="pre">.opt</span></code> file.
For example if we write in the main set <code class="docutils literal notranslate"><span class="pre">e_coli_glc1-6n.opt</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Name    Value
prl_exp e_coli_glc2n,e_coli_glc3n,e_coli_glc4n,e_coli_glc5n,e_coli_glc6n
</pre></div>
</div>
<p>then the command to run parallel experiments becomes simply:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ influx_s.py --pref e_coli_glc1-6n
</pre></div>
</div>
<p>This example set of files correspond to stationary labeling experiments described in “Complete-MFA: Complementary parallel labeling experiments technique for metabolic flux analysis”, Robert W. Leighty, Maciek R. Antoniewicz, <em>Metabolic Engineering</em> 20 (2013) 49–55 (with only difference that we use simulated and noised data instead of measured ones).</p>
<p>We also provide an example of simulated instationary parallel experiments in the files <code class="docutils literal notranslate"><span class="pre">e_coli_GX_prl</span></code> (main files) and <code class="docutils literal notranslate"><span class="pre">e_coli_GX_X</span></code> (secondary files) corresponding to simultaneous consumption of glucose and xylose. The network for these simulations was borrowed from “13C metabolic flux analysis of microbial and mammalian systems is enhanced with GC-MS measurements of glycogen and RNA labeling”, Christopher P. Long, Jennifer Au, Jacqueline E. Gonzalez, Maciek R. Antoniewicz, Metabolic Engineering 38 (2016) 65–72. The experiment consisted in dynamic labeling by uniformly labeled glucose (main experiment)  and by uniformly labeled xylose (secondary one). Labeling kinetics MS data are given in <code class="docutils literal notranslate"><span class="pre">e_coli_GX_MS.miso</span></code> and <code class="docutils literal notranslate"><span class="pre">e_coli_GX_X_MS.miso</span></code> files respectively. To play with this example (still in the same directory), you can run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ influx_i.py e_coli_GX_prl
</pre></div>
</div>
<p>Note that set of measured specie fragments as well as sampling time points for instationary labeling are not necessary the same for instationary experiments. They do
can differ. That’s why a <code class="docutils literal notranslate"><span class="pre">.opt</span></code> can be necessary to add to <code class="docutils literal notranslate"><span class="pre">.miso/.linp</span></code> couple to form a complete parallel experiment.</p>
<p>It should be made a clear distinction between parallel experiments described in this section and independent experiments calculated in parallel. The main difference is that parallel experiments of this section share all the same flux map (only labeling pattern and data can differ) while independent experiments can have each its own flux map, be they calculated in parallel or sequentially.</p>
</section>
<section id="options-in-opt-file">
<h2>Options in .opt file<a class="headerlink" href="#options-in-opt-file" title="Permalink to this heading">¶</a></h2>
<p>In this section, we describe different options that can appear in .opt file</p>
<section id="optimization-options">
<span id="optopt"></span><h3>Optimization options<a class="headerlink" href="#optimization-options" title="Permalink to this heading">¶</a></h3>
<p>These options can help to tune the convergence process of the NLSIC (or any other chosen algorithm). These options are prefixed with <code class="docutils literal notranslate"><span class="pre">optctrl</span></code> which is followed by a particular optimization method name and ended by an option name. For example, <code class="docutils literal notranslate"><span class="pre">optctrl:nlsic:errx</span></code> corresponds to the stopping criterion. A corresponding <code class="docutils literal notranslate"><span class="pre">.opt</span></code> portion could look like</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Name                    Value
optctrl:nlsic:errx      1.e-3
</pre></div>
</div>
<section id="nlsic-parameters">
<h4>NLSIC parameters<a class="headerlink" href="#nlsic-parameters" title="Permalink to this heading">¶</a></h4>
<p>All possible options and their default values for NLSIC algorithm follow:</p>
<blockquote>
<div><dl class="simple">
<dt>errx=1.e-5</dt><dd><p>stopping criterion. When the L2 norm of the increment vector of free parameters is below this value, the iterations are stopped.</p>
</dd>
<dt>maxit=50</dt><dd><p>maximal number for non-linear iterations.</p>
</dd>
<dt>btstart=1.</dt><dd><p>backtracking starting coefficient</p>
</dd>
<dt>btfrac=0.25</dt><dd><p>backtracking fraction parameter. It corresponds to the alpha parameter in the paper on <code class="docutils literal notranslate"><span class="pre">influx_s</span></code></p>
</dd>
<dt>btdesc=0.1</dt><dd><p>backtracking descending parameter. It corresponds to the beta parameter in the paper on <code class="docutils literal notranslate"><span class="pre">influx_s</span></code></p>
</dd>
<dt>btmaxit=15</dt><dd><p>maximal number of backtracking iterations</p>
</dd>
<dt>trace=1</dt><dd><p>report (=1) or not (=0) minimal convergence information</p>
</dd>
<dt>rcond=1.e10</dt><dd><p>condition number over which a matrix is considered as rank deficient</p>
</dd>
<dt>ci=list(p=0.95, report=F)</dt><dd><p>confidence interval reporting. This option is own to <code class="docutils literal notranslate"><span class="pre">nlsic()</span></code> function. It has no impact on the reporting of linear stats information in the result kvh file after the post-optimization treatment. This latter is always done.</p>
</dd>
<dt>history=FALSE</dt><dd><p>return or not (default) the matrices with optimization steps and residual vectors during optimization. These matrices can then be found as part of <code class="docutils literal notranslate"><span class="pre">optimization</span> <span class="pre">process</span> <span class="pre">information/history</span></code> field in <code class="docutils literal notranslate"><span class="pre">mynetwork_res.kvh</span></code> file. Use it with caution, big size matrices can be generated requiring much of memory and disk space.</p>
</dd>
<dt>adaptbt=TRUE</dt><dd><p>use (default) or not an adaptive backtracking algorithm.</p>
</dd>
<dt>monotone=FALSE</dt><dd><p>should or not the cost decrease be monotone. If TRUE, then at first non decrease of the cost, the iterations are stopped with a warning message.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="pso-parameters">
<h4>PSO parameters<a class="headerlink" href="#pso-parameters" title="Permalink to this heading">¶</a></h4>
<p>Particle Swarm Optimization (PSO) is a stochastic optimization method. It can help to avoid local minimums but its convergence is very slow. That’s why its usage can be particularly useful if combined with a deterministic algorithm like NLSIC. We have implemented PSO method based on the code from CRAN package <a class="reference external" href="https://cran.r-project.org/package=pso">pso v1.0.3</a>  published in 2012 by Claus Bendtsen (papyrus.bendtsen at gmail.com). The original algorithm was written for box constrained problems. While <code class="docutils literal notranslate"><span class="pre">influx_si</span></code> requires a usage of general linear constraints. So we modified the algorithms accordingly. Its parameters with their default values used in <code class="docutils literal notranslate"><span class="pre">influx_si</span></code> are following:</p>
<blockquote>
<div><dl class="simple">
<dt>trace=0</dt><dd><p>an integer controlling the trace printing. A zero value means no printing</p>
</dd>
<dt>fnscale=1</dt><dd><p>scale factor for minimized function. It is useless in <code class="docutils literal notranslate"><span class="pre">influx_si</span></code> context.</p>
</dd>
<dt>maxit=100</dt><dd><p>maximal iteration number to not overcome</p>
</dd>
<dt>maxf=Inf</dt><dd><p>maximal number of a cost function evaluation</p>
</dd>
<dt>abstol=-Inf</dt><dd><p>stopping criterion by absolute tolerance during approximating the searched minimum. This parameter can only be useful if the searched minimal value is known in advance. It is not the case of <code class="docutils literal notranslate"><span class="pre">influx_si</span></code></p>
</dd>
<dt>reltol=0</dt><dd><p>stopping criterion by relative change in the found minimal value</p>
</dd>
<dt>REPORT = 10</dt><dd><p>if tracing is enabled, this parameters gives the number of iterations passed between two successive reports</p>
</dd>
<dt>s=NA,</dt><dd><p>swarm size. If NA, it is automatically determined.</p>
</dd>
<dt>k=3, p=NA, w=1/(2*log(2)), c.p=.5+log(2), c.g=.5+log(2)</dt><dd><p>are parameters governing PSO minimization paths. For their significance see the original <a class="reference external" href="https://cran.r-project.org/web/packages/pso/pso.pdf">pso documentation</a></p>
</dd>
<dt>d=NA</dt><dd><p>domain diameter</p>
</dd>
<dt>v.max=NA</dt><dd><p>maximum allowed velocity</p>
</dd>
<dt>rand.order=TRUE</dt><dd><p>proceed swarm particles in random order or not</p>
</dd>
<dt>max.restart=Inf</dt><dd><p>maximal allowed restarts</p>
</dd>
<dt>maxit.stagnate=Inf</dt><dd><p>maximal successive iterations allowed without a detected decrease in optimization function.</p>
</dd>
<dt>trace.stats=FALSE</dt><dd><p>return or not detailed statistics about the convergence process (not used in <code class="docutils literal notranslate"><span class="pre">influx_si</span></code>)</p>
</dd>
<dt>type=”SPSO2011”,</dt><dd><p>which PSO strategy to use. Available options are “SPSO2011” and “SPSO2007”. More about this in the original documentation.</p>
</dd>
<dt>tolineq=1.e-10</dt><dd><p>tolerance for violating of linear constraints that can happen mainly due to rounding errors.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="other-optimization-methods">
<h4>Other optimization methods<a class="headerlink" href="#other-optimization-methods" title="Permalink to this heading">¶</a></h4>
<p>Names and default values for BFGS and Nelder-Mead algorithms can be found in the R help on <code class="docutils literal notranslate"><span class="pre">optim()</span></code> function.</p>
</section>
</section>
<section id="growth-flux-option">
<span id="growthflux"></span><h3>Growth flux option<a class="headerlink" href="#growth-flux-option" title="Permalink to this heading">¶</a></h3>
<p>If present, this option makes <code class="docutils literal notranslate"><span class="pre">influx_si</span></code> take into account growth fluxes <span class="math notranslate nohighlight">\(-\mu{}M\)</span> in the flux balance, where <span class="math notranslate nohighlight">\(\mu\)</span> is a growth rate and <span class="math notranslate nohighlight">\(M\)</span> is a concentration of an internal specie M by a unit of biomass. Only species for which this concentration is provided in a .tvar file, contribute to flux balance with a flux <span class="math notranslate nohighlight">\(-\mu{}M\)</span>.
This flux can be varying or constant during optimization process depending on whether the specie M is part of free parameters to fit or not. Usually, taking into account of this kind of flux does not influence very much on the estimated flux values. So, this option is provided to allow a user to be sure that it is true in his own case.</p>
<p>The option is activated by a field <code class="docutils literal notranslate"><span class="pre">include_growth_flux</span></code>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Name                    Value
include_growth_flux     1
</pre></div>
</div>
<p>Value 0 cancels the contribution of the growth fluxes to the general flux balance.</p>
<p>Another necessary option is <code class="docutils literal notranslate"><span class="pre">mu</span></code> giving the value of <cite>µ</cite>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Name    Value
mu      0.12
</pre></div>
</div>
<p>Please note that the specie concentrations by a unit of biomass are reported in a file .tvar as:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Name    Kind    Type    Value
Fum     METAB   C       2.47158569399681
Suc     METAB   F       15.8893144279264
Mal     METAB   F       6.47828321758155
...     ...
</pre></div>
</div>
<p>Specie names used in this section must be identical to those used in the .netw file and others. “F” is used as an indicator of a varying specie pool. Such varying species are part of fitted parameters. Column “Value” is used as starting value in the optimization process.</p>
<p>One of valuable originality of <code class="docutils literal notranslate"><span class="pre">influx_s</span></code>, it is a possibility to couple fluxomics and metabolomics in stationary experiments. It can be done because specie pools can influence labeling in two ways:</p>
<blockquote>
<div><ul class="simple">
<li><p>through specie pooling (due to compartmentalization and/or co-elution during chromatography)</p></li>
<li><p>through growth fluxes.</p></li>
</ul>
</div></blockquote>
<p>This last influence is often of low intensity compared to specie transformation fluxes. In literature, it is typically neglected.</p>
<p>Another possibility that was added <code class="docutils literal notranslate"><span class="pre">influx_si</span></code> is to provide measured specie concentrations in <code class="docutils literal notranslate"><span class="pre">.mmet</span></code> file:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Specie                  Value                           SD
Suc                     15.8893144279264*1.e-3/10.7     1.e-2
Mal                     6.47828321758155*1.e-3/10.7     1.e-2
Rub5P+Rib5P+Xul5P       1.66034545348219*1.e-3/10.7     1.e-2
</pre></div>
</div>
<p>Like for other measurements, the user has to provide a name, a value, and a standard deviation for each entry. Species listed in this section must be defined in the .netw file and must have type “F” in the <code class="docutils literal notranslate"><span class="pre">.tvar</span></code>. Numerical values can be simple arithmetic expressions (as in the example above) which are evaluated during file parsing.</p>
<p>When a specie name is given as a sum of species (e.g. <code class="docutils literal notranslate"><span class="pre">Rub5P+Rib5P+Xul5P</span></code>) it is interpreted as a list of species to be pooled. It is done proportionally to their concentrations. No numerical factor can appear in this sum. At least one of the species from the list must be free (i.e. to have “F” type in the <code class="docutils literal notranslate"><span class="pre">.tvar</span></code> file). Otherwise, all species from the list would be considered as having a fixed concentration and providing a measurement for such species would be meaningless.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Species having “F” (as “Free”) in column “Type” in a .tvar file are treated as fittable parameters. We recall that species in this file are identified as having “METAB” in column “Kind”.</p>
</div>
<p>An example of an MTF files having specie sections and involving growth fluxes can be found in <code class="docutils literal notranslate"><span class="pre">test/mtf/e_coli_growth.*</span></code>.</p>
</section>
<section id="post-treatment-option">
<h3>Post treatment option<a class="headerlink" href="#post-treatment-option" title="Permalink to this heading">¶</a></h3>
<p>User can specify a name of one or several R scripts that will be automatically executed after non aborted <code class="docutils literal notranslate"><span class="pre">influx_si</span></code> run. This option can be useful, for example, for plain saving of calculation environment in a file for later exploring in an interactive R session or for plotting results in a pdf file and so on. A very basic example of such a script is provided in the file <code class="docutils literal notranslate"><span class="pre">R/save_all.R</span></code> and its use can be found in the options of <code class="docutils literal notranslate"><span class="pre">test/e_coli.opt</span></code> file.</p>
<p>To activate this option, the script names must be provided in the <code class="docutils literal notranslate"><span class="pre">.opt</span></code> file, in the field <code class="docutils literal notranslate"><span class="pre">posttreat_R</span></code> and separated by <code class="docutils literal notranslate"><span class="pre">';</span> <span class="pre">'</span></code>, e.g.:</p>
<blockquote>
<div><div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Name            Value
posttreat_R     save_all.R; plot_smeas.R
</pre></div>
</div>
</div></blockquote>
<p>The script name is interpreted as a relative path to the directory where the original MTF files are located.  If the file is not found there, it is searched for in <code class="docutils literal notranslate"><span class="pre">influx_si/R</span></code>.
After execution of <code class="docutils literal notranslate"><span class="pre">save_all.R</span></code>, a file <code class="docutils literal notranslate"><span class="pre">e_coli.RData</span></code> is created. This particular example can be used to restore a calculation R environment by launching R and executing:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>&gt; load<span class="o">(</span><span class="s2">&quot;e_coli.RData&quot;</span><span class="o">)</span>
</pre></div>
</div>
<p>After that, all variables defined in influx_si at the end of the calculations will be available in the current interactive session.
To be able to launch custom calculations on these variables, the user has to do some preliminary actions. An example of such actions can be found in a file <code class="docutils literal notranslate"><span class="pre">preamble.R</span></code> which can be adapted for user’s case.</p>
<p>To write his own scripts for post treatments or explore the calculated values in an interactive session, a user have to know some basics about existent variables where all the calculation results and auxiliary information are stored. Here are few of them:</p>
<dl>
<dt>dirw</dt><dd><p>is a working directory (where the original FTBL file is)</p>
</dd>
<dt>dirx</dt><dd><p>is an executable directory (where influx_s.py is)</p>
</dd>
<dt>baseshort</dt><dd><p>is a short name of the input FTBL file (without the suffix <code class="docutils literal notranslate"><span class="pre">.ftbl</span></code> neither the directory part of the path)</p>
</dd>
<dt>param</dt><dd><p>is the vector of the estimated parameters composed of free fluxes, scaling parameters (if any) and specie concentrations (if any)</p>
</dd>
<dt>labargs</dt><dd><p>is an environment with all necessary data for label simulation (e.g. <code class="docutils literal notranslate"><span class="pre">v=lab_sim(param,</span> <span class="pre">cjac=FALSE,</span> <span class="pre">labargs)</span></code>) or residual calculation (e.g. <code class="docutils literal notranslate"><span class="pre">rres=lab_resid(param,</span> <span class="pre">cjac=TRUE,</span> <span class="pre">labargs)</span></code>)</p>
</dd>
<dt>jx_f</dt><dd><p>is a environment regrouping calculated quantities. Here are some of its fields:</p>
<p><code class="docutils literal notranslate"><span class="pre">lf</span></code> a list with different fluxes:</p>
<blockquote>
<div><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">fallnx</span></code></dt><dd><p>a vector of all net and exchange fluxes (here, exchange fluxes are mapped on [0; 1[ interval)</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">fwrv</span></code></dt><dd><p>a vector of forward and reverse fluxes (reverse fluxes are “as is”, i.e. not mapped)</p>
</dd>
</dl>
</div></blockquote>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">xsim</span></code></dt><dd><p>is an internal state label vector</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">simlab</span></code>, <code class="docutils literal notranslate"><span class="pre">simfmn</span></code> and <code class="docutils literal notranslate"><span class="pre">simpool</span></code></dt><dd><p>are vectors of simulated measurements for label, net flux and specie pools respectively (fitting at the best of influx_s’ capacity the provided measurements)</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">res</span></code></dt><dd><p>is the reduced residual vector, i.e. (simulated-measured)/SD</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">ures</span></code></dt><dd><p>is the unreduced residual vector, i.e. (simulated-measured)</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">jacobian</span></code></dt><dd><p>as its names indicates, is the Jacobian matrix (d res/d param)</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">udr_dp</span></code></dt><dd><p>is the Jacobian matrix for the unreduced residual vector (d ures/d param)</p>
</dd>
</dl>
</dd>
<dt>measurements</dt><dd><p>is a list regrouping various measurements and their SD</p>
</dd>
<dt>nb_f</dt><dd><p>is a list of various counts, like number of fluxes, parameters to fit, system sizes and so on</p>
</dd>
<dt>nm_list</dt><dd><p>is a list of names for various vectors like fluxes, species, label vectors, measurements, inequalities and so on</p>
</dd>
<dt>ui, ci</dt><dd><p>are inequality matrix and right-hand side respectively</p>
</dd>
</dl>
<p>A full list of all available variable and functions can be obtained in an R session by executing:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>&gt; ls<span class="o">()</span>
</pre></div>
</div>
<p>This list of more than 400 items is too long to be fully described here. We hope that the few items succinctly described in this section will be sufficient for basic custom treatments.</p>
<p>An inspiration for your own custom treatments and/or plotting can be found in files <code class="docutils literal notranslate"><span class="pre">plot_ilab.R</span></code> and <code class="docutils literal notranslate"><span class="pre">plot_smeas.R</span></code> that plot instationary and stationary data respectively in pdf files.</p>
</section>
<section id="exclusive-influx-i-options">
<h3>Exclusive <code class="docutils literal notranslate"><span class="pre">influx_i</span></code> options<a class="headerlink" href="#exclusive-influx-i-options" title="Permalink to this heading">¶</a></h3>
<p>There is only one exclusive option that can be given on a command line:</p>
<blockquote>
<div><dl class="option-list">
<dt><kbd><span class="option">--time_order=<var>TIME_ORDER</var></span></kbd></dt>
<dd><p>Time order for ODE solving (1 (default), 2 or 1,2).
Order 2 is more precise but more time-consuming. The
value ‘1,2’ makes to start solving the ODE with the first
order scheme then continues with the order 2.</p>
<p>The scheme order can be important for the precision of flux and concentration estimations. The impact is not direct, but can be very significant. Please note that it can happen that order 1 fits the data with lower cost value function, but it does not mean that the fluxes/concentrations are better estimated.</p>
</dd>
</dl>
</div></blockquote>
<p>Other options can occur as fields in a <code class="docutils literal notranslate"><span class="pre">.opt</span></code> file.</p>
<blockquote>
<div><dl>
<dt><code class="docutils literal notranslate"><span class="pre">nsubdiv_dt</span></code></dt><dd><p>integer number of sub-intervals by which every time interval is divided to increase the precision of time resolution.</p>
<p>It can happen that the value 1 (default) is sufficient for a satisfactory flux/concentration estimation. User can gradually increase this value (2, 3, …) in successive <code class="docutils literal notranslate"><span class="pre">influx_i</span></code> runs to be sure that better time resolution does not impact parameter estimation. This property is called <em>grid convergence</em>. A grid convergence is necessary to overcome the result dependency on the choice of a numerical discretization scheme. A grid convergence can be considered as achieved when changes in estimated parameters provoked by a grid refinement are significantly lower than estimated confidence intervals for these parameters.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">dt</span></code></dt><dd><p>a real positive number, defines a time step in a regular grid in absence of values in “Time” column in <code class="docutils literal notranslate"><span class="pre">.miso</span></code> file.
If a “Time” values are well present for label kinetics, then this parameter has no effect.</p>
<p>A regular time grid for label simulations can be useful on preliminary stage when user only elaborates MTF files and wants to see if label simulation are plausible. It can also help to produce simulated measurements (which can be extracted from the <code class="docutils literal notranslate"><span class="pre">_res.kvh</span></code> file) for further numerical experiments like studying convergence speed, parameter identifiability, noise impact and so on.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">tmax</span></code></dt><dd><p>a real positive number, defines the end of a regular time grid if “Time” is empty or absent in <code class="docutils literal notranslate"><span class="pre">.miso</span></code>. Parameters <code class="docutils literal notranslate"><span class="pre">dt</span></code> and <code class="docutils literal notranslate"><span class="pre">tmax</span></code> must be defined in such a way that there will be at least 2 time points greater than 0 in the time grid.</p>
<p>If “Time” values are well present in <code class="docutils literal notranslate"><span class="pre">.miso</span></code> then this parameter can be used to limit the time grid on which the simulations are done. If the value in <code class="docutils literal notranslate"><span class="pre">tmax</span></code> is greater than the maximal time value defined in <code class="docutils literal notranslate"><span class="pre">.miso</span></code> file then this parameter has no effect.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is very important that the values for time, flux, and specie concentrations be expressed in concordant units. It would be meaningless to give time in minutes, fluxes in mM/h/g and concentrations in mM. This will lead to wrong results.</p>
<p>For example, if the time is expressed in seconds and concentrations in mM/g then fluxes must be expressed in mM/s/g.</p>
</div>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">funlabR</span></code></dt><dd><p>since v5.4, <code class="docutils literal notranslate"><span class="pre">influx_i</span></code> is able to simulate label propagation in a metabolically stationary network from a label input varying in time. User can supply R expressions which will calculate fractions of different input label components as functions of time <code class="docutils literal notranslate"><span class="pre">t</span></code>. Those expressions can be provided in the <code class="docutils literal notranslate"><span class="pre">Value</span></code> column of <code class="docutils literal notranslate"><span class="pre">.linp</span></code> file but they can need some helper functions. Few of them are defined in a file <code class="docutils literal notranslate"><span class="pre">funlab.R</span></code> included in <code class="docutils literal notranslate"><span class="pre">influx_si</span></code> but user can need more of them. Thanks to this field, he can define them in a custom R file, who’s name can be provided here. There can be given only one file. However, if user-defined functions are spread over several files, they can be included via <code class="docutils literal notranslate"><span class="pre">source()</span></code> function called from this one. For this purpose, a predefined variable <code class="docutils literal notranslate"><span class="pre">dirw</span></code> pointing to the current working directory can be useful. It is worth mentioning that the file defined in this field will be executed in a particular environment so that variables created during its execution won’t affect <code class="docutils literal notranslate"><span class="pre">influx_si</span></code>’s ones. The path of the file provided in this field is relative to the .netw’s one. Example:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Name            Value
funlabR         e_coli_iv_funlab.R  # the file &#39;e_coli_iv_funlab.R&#39; is in the same directory that &#39;e_coli_iv.*&#39; MTF set
</pre></div>
</div>
<p>Functions that are available in <code class="docutils literal notranslate"><span class="pre">funlab.R</span></code> are following:</p>
<blockquote>
<div><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">ppulses(tp,</span> <span class="pre">Tint,</span> <span class="pre">Hint=rep_len(c(1.,</span> <span class="pre">0.),</span> <span class="pre">length(Tint)))</span></code></dt><dd><p>computes a signal in the form of periodic rectangular pulses in time points <code class="docutils literal notranslate"><span class="pre">tp</span></code>. Each period is composed of one or several intervals whose length in time is given in numeric vector <code class="docutils literal notranslate"><span class="pre">Tint</span></code> and heights of signals are given in optional numeric vector <code class="docutils literal notranslate"><span class="pre">Hint</span></code>. By default, <code class="docutils literal notranslate"><span class="pre">Hint</span></code> is a sequence of 1’s and 0’s. The very first period starts at t=0. Returns a numeric vector of the same length as <code class="docutils literal notranslate"><span class="pre">tp</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">linterp(tp,</span> <span class="pre">knots,</span> <span class="pre">v)</span></code></dt><dd><p>computes a signal in the form of continuous linear piece-wise functions in time points <code class="docutils literal notranslate"><span class="pre">tp</span></code>. The limits of linear intervals are defined in numeric vector <code class="docutils literal notranslate"><span class="pre">knots</span></code> and values at limits must be given in numeric vector <code class="docutils literal notranslate"><span class="pre">v</span></code>. All <code class="docutils literal notranslate"><span class="pre">tp</span></code> values must lie between <code class="docutils literal notranslate"><span class="pre">min(knots)</span></code> and <code class="docutils literal notranslate"><span class="pre">max(knots)</span></code>. Returns a numeric vector of the same length as <code class="docutils literal notranslate"><span class="pre">tp</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">steplinpath(tp,</span> <span class="pre">nu)</span></code></dt><dd><p>computes labeling in a linear pathway of non-reversible reactions under step labeling with fully unlabeled initial state, i.e. starting from 0. The signal is calculated in time points <code class="docutils literal notranslate"><span class="pre">tp</span></code>. The pathway is defined by numeric vector <code class="docutils literal notranslate"><span class="pre">nu</span></code> which represents turn-over rates (i.e. a ratio Flux/Specie_Concentration). All values in <code class="docutils literal notranslate"><span class="pre">nu</span></code> must be pairwise different. Returns a numeric matrix of size m x n, where number of rows m=length(nu) and number of columns n=length(tp). So, for example, if a signal only of the third specie is required, the function can be called as <code class="docutils literal notranslate"><span class="pre">steplinpath(tp,</span> <span class="pre">nu)[3,]</span></code></p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">steplinpath2(tp,</span> <span class="pre">nu,</span> <span class="pre">init=double(length(nu)),</span> <span class="pre">height=1.)</span></code></dt><dd><p>The same as <code class="docutils literal notranslate"><span class="pre">steplinpath()</span></code> above but initial state can be different from 0. It can be defined in numeric vector <code class="docutils literal notranslate"><span class="pre">init</span></code> of the same length as <code class="docutils literal notranslate"><span class="pre">nu</span></code>. The label amplitude can be given in a scalar <code class="docutils literal notranslate"><span class="pre">height</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">ppulseslinpath(tp,</span> <span class="pre">nu,</span> <span class="pre">Tint,</span> <span class="pre">Hint=rep_len(c(1.,</span> <span class="pre">0.),</span> <span class="pre">length(Tint)),</span> <span class="pre">init=double(length(nu)))</span></code></dt><dd><p>computes labeling of linear non-reversible pathway under input composed of periodic rectangular pulses. Labeling for all species is calculated in time points <code class="docutils literal notranslate"><span class="pre">tp</span></code>. Each period is composed of one or several intervals whose length in time is given in numeric vector <code class="docutils literal notranslate"><span class="pre">Tint</span></code> and heights of signals are given in optional numeric vector <code class="docutils literal notranslate"><span class="pre">Hint</span></code>. By default, <code class="docutils literal notranslate"><span class="pre">Hint</span></code> is a sequence of 1’s and 0’s. Initial label levels can be defined in numeric vector <code class="docutils literal notranslate"><span class="pre">init</span></code>. Returns a numeric matrix of size m x n, where number of rows m=length(nu) and number of columns n=length(tp).</p>
</dd>
</dl>
</div></blockquote>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">Value</span></code> column in <code class="docutils literal notranslate"><span class="pre">.linp</span></code></dt><dd><p>in this field, user can provide R expression calculating fractions of input label as function of time. While for <code class="docutils literal notranslate"><span class="pre">influx_s</span></code>, it can only be a constant or python expression evaluating to a scalar at compilation time. Such R expressions can refer to a scalar variable <code class="docutils literal notranslate"><span class="pre">t</span></code> representing the current time point and should return a scalar value representing a label level between 0 and 1. The sum of all label levels relative to a given specie must be 1 if a full set of isotopomer is provided by user. If one or many isotopomers are lacking, usual conventions apply for completion to 1 (cf. <a class="reference internal" href="#mtf-format">MTF format</a>).</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span># .linp example
Specie  Isotopomer      Value
Gluc_U  111111          ppulses(t, c(T1,T2))  # periodic pulses composed of intervals of length T1 (&quot;labeled&quot;) and T2 (&quot;unlabeled&quot;)
Gluc_1  100000          ppulses(t, c(T1,T2))

# .opt example
Name    Value
funlabR e_coli_iv_funlab.R  // in this R file variables T1 and T2 are defined
</pre></div>
</div>
<p>Input isotopomers that are absent in such <code class="docutils literal notranslate"><span class="pre">funlab</span></code> fields are supposed to be 0 all the time (except for above-mentioned conventions).</p>
<p>If a label level cannot be calculated in one arithmetic operation, several R statements can be placed between curled braces <code class="docutils literal notranslate"><span class="pre">{}</span></code> separated by semicolon <code class="docutils literal notranslate"><span class="pre">;</span></code>. The last operation must be the searched result. In the example above, we could exclude usage of helper file <code class="docutils literal notranslate"><span class="pre">e_coli_iv_funlab.R</span></code> by defining <code class="docutils literal notranslate"><span class="pre">T1</span></code> and <code class="docutils literal notranslate"><span class="pre">T2</span></code> directly in the expressions:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span># .linp example
Specie  Isotopomer      Value
Gluc_U  111111          {T1=2; T2=2; ppulses(t, c(T1,T2))}
Gluc_1  100000          {T1=2; T2=2; ppulses(t, c(T1,T2))}
</pre></div>
</div>
</dd>
</dl>
</div></blockquote>
</section>
</section>
<section id="old-result-file-fields">
<h2>Old Result File Fields<a class="headerlink" href="#old-result-file-fields" title="Permalink to this heading">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Starting from v7.0 results are written in MTF format described above. So this section is kept only for legacy reason and is not more necessary for reading.</p>
</div>
<p>Generally speaking, the names of the fields in the result KVH file are chosen to be self-explanatory. So there is no so much to say about them. Here, we provide only some key fields and name conventions used in the result file.</p>
<p>At the beginning of the <code class="docutils literal notranslate"><span class="pre">mynetwork_res.kvh</span></code> file, some system information is provided. Here, “system” should be taken in two sens: informatics and biological. The information is reported in the fields  <code class="docutils literal notranslate"><span class="pre">influx</span></code> and  <code class="docutils literal notranslate"><span class="pre">system</span> <span class="pre">sizes</span></code>. These fields are followed by  <code class="docutils literal notranslate"><span class="pre">starting</span> <span class="pre">point</span></code> information regrouping <code class="docutils literal notranslate"><span class="pre">starting</span> <span class="pre">free</span> <span class="pre">parameters</span></code>,  <code class="docutils literal notranslate"><span class="pre">starting</span> <span class="pre">cost</span> <span class="pre">value</span></code>, <code class="docutils literal notranslate"><span class="pre">flux</span> <span class="pre">system</span> <span class="pre">(Afl)</span></code> and <code class="docutils literal notranslate"><span class="pre">flux</span> <span class="pre">system</span> <span class="pre">(bfl)</span></code>. Name conventions used in these and other fields are the following:</p>
<blockquote>
<div><dl>
<dt>net and exchange fluxes</dt><dd><p>are prefixed by <code class="docutils literal notranslate"><span class="pre">n.</span></code> or <code class="docutils literal notranslate"><span class="pre">x.</span></code> respectively</p>
</dd>
<dt>free, dependent, constrained and variable growth fluxes</dt><dd><p>are prefixed by <code class="docutils literal notranslate"><span class="pre">f.</span></code>, <code class="docutils literal notranslate"><span class="pre">d.</span></code>, <code class="docutils literal notranslate"><span class="pre">c.</span></code> and <code class="docutils literal notranslate"><span class="pre">g.</span></code> respectively. So, a complete flux name could look like <code class="docutils literal notranslate"><span class="pre">f.n.zwf</span></code> which means <cite>free net ZWF flux</cite>.
Growth fluxes which depend on constant specie concentrations can be found in constrained fluxes. Constant or variable growth fluxes are postfixed with <code class="docutils literal notranslate"><span class="pre">_gr</span></code> (as <cite>growth</cite>) string. For example, a flux <code class="docutils literal notranslate"><span class="pre">g.n.Cit_gr</span></code> corresponds to a net growth flux of Citrate specie. The growth fluxes are all set as non-reversible, so all exchange fluxes like <code class="docutils literal notranslate"><span class="pre">g.x.M_gr</span></code> or <code class="docutils literal notranslate"><span class="pre">c.x.M_gr</span></code> are set to 0.</p>
</dd>
<dt>scaling factors names</dt><dd><p>are formed according to a pattern similar to <code class="docutils literal notranslate"><span class="pre">label;Ala;1</span></code> which corresponds to the first group of measurements on Alanine molecule in labeling experiments. Other possible types of experiments are <code class="docutils literal notranslate"><span class="pre">peak</span></code> and <code class="docutils literal notranslate"><span class="pre">mass</span></code>.</p>
</dd>
<dt>MID vector names</dt><dd><p>are looking like <code class="docutils literal notranslate"><span class="pre">METAB+N</span></code> where <code class="docutils literal notranslate"><span class="pre">METAB</span></code> is specie name and <code class="docutils literal notranslate"><span class="pre">N</span></code> goes from 0 to the number of carbon atoms in the considered molecule.</p>
</dd>
<dt>cumomer names</dt><dd><p>follow classical convention <code class="docutils literal notranslate"><span class="pre">METAB#pattern_of_x_and_1</span></code>, e.g. <code class="docutils literal notranslate"><span class="pre">Ala#x1x</span></code></p>
</dd>
<dt>forward and reverse fluxes</dt><dd><p>are prefixed by <code class="docutils literal notranslate"><span class="pre">fwd.</span></code> and <code class="docutils literal notranslate"><span class="pre">rev.</span></code> respectively, e.g. <code class="docutils literal notranslate"><span class="pre">fwd.zwf</span></code> or <code class="docutils literal notranslate"><span class="pre">rev.zwf</span></code></p>
</dd>
<dt>measurement names</dt><dd><p>have several fields separated by a colon <code class="docutils literal notranslate"><span class="pre">:</span></code>. For example, <code class="docutils literal notranslate"><span class="pre">l:Asp:#xx1x:694</span></code> deciphers like:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">l</span></code> stands for <cite>labeling</cite> experiment (others possibilities are <code class="docutils literal notranslate"><span class="pre">p</span></code> for <cite>peak</cite>, <code class="docutils literal notranslate"><span class="pre">m</span></code> for <cite>mass</cite> and <code class="docutils literal notranslate"><span class="pre">pm</span></code> for <cite>specie pool</cite>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Asp</span></code> is a specie name</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">#xx1x</span></code> is a measurement identification</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">694</span></code> is a line number in the FTBL file corresponding to this measurement.</p></li>
</ul>
</div></blockquote>
</dd>
</dl>
</div></blockquote>
<p>The field <code class="docutils literal notranslate"><span class="pre">optimization</span> <span class="pre">process</span> <span class="pre">information</span></code> is the key field presenting the results of an optimization process. The fitted parameters are in the subfield <code class="docutils literal notranslate"><span class="pre">par</span></code>. Other subfields provide some additional information.</p>
<p>The final cost value is in the field <code class="docutils literal notranslate"><span class="pre">final</span> <span class="pre">cost</span></code>.</p>
<p>The values of vectors derived from free fluxes like dependent fluxes, cumomers, MID and so on are in the corresponding fields whose names can be easily recognized.</p>
<p>Linear stats and Monte-Carlo statistics are presented in their respective fields. The latter field is present only if explicitly requested by user with <code class="docutils literal notranslate"><span class="pre">--sens</span> <span class="pre">mc=MC</span></code> option. In this kvh section, a term <code class="docutils literal notranslate"><span class="pre">rsd</span></code> means “relative standard deviation” (in literature, it is often encountered a synonym CV as Coefficient of Variation). It is calculated as SD/Mean and if expressed in percentage then the formula becomes 100%*SD/Mean.</p>
<p>The field <code class="docutils literal notranslate"><span class="pre">jacobian</span> <span class="pre">dr_dp</span> <span class="pre">(without</span> <span class="pre">1/sd_exp)</span></code> report a Jacobian matrix which is defined as a matrix of partial derivatives <span class="math notranslate nohighlight">\(\partial{r}/\partial{p}\)</span> where <em>r</em> is residual vector (Simulated–Measured) and <em>p</em> is a free parameter vector including free fluxes, scaling factors (if any) and free specie pools (if any). Note that in this definition, the residual vector is not yet scaled by standard deviation of measurements. Sometimes, Jacobian is called <em>sensitivity matrix</em>, in which case a special care should be brought to the sens of derivation. Often, by sensitivity matrix, we intend a matrix expressing how estimated fluxes are sensitive to variations in the measurement data. Such definition corresponds to generalized inverse of Jacobian and it is reported in the field <code class="docutils literal notranslate"><span class="pre">generalized</span> <span class="pre">inverse</span> <span class="pre">of</span> <span class="pre">jacobian</span> <span class="pre">dr_dp</span> <span class="pre">(without</span> <span class="pre">1/sd_exp)</span></code></p>
</section>
<section id="network-values-for-cytoscape">
<h2>Network values for Cytoscape<a class="headerlink" href="#network-values-for-cytoscape" title="Permalink to this heading">¶</a></h2>
<p>Several network values formatted for cytoscape are written by <code class="docutils literal notranslate"><span class="pre">influx_si</span></code> to their respective files. It can facilitate their visualizing and presentation in graphical mode. All these values can be mapped on various graphical attributes like edge width, node size or color scale of them. These files are written at the end of calculations, so if an error has interrupted this process, no such file will be produced. Take care to don’t use an outdated copy of these files.</p>
<p>A file named <code class="docutils literal notranslate"><span class="pre">edge.netflux.mynetwork.attrs</span></code> can help to map net flux values on edges of a studied network. A file <code class="docutils literal notranslate"><span class="pre">edge.xchflux.mynetwork.attrs</span></code> do the same with exchange fluxes. And finally, <code class="docutils literal notranslate"><span class="pre">node.log2pool.mynetwork.attrs</span></code> provides logarithm (base 2) of pool concentrations. They can be mapped on some graphical attribute of network nodes.</p>
<p>See <a class="reference internal" href="#additional-tools">Additional tools</a> section, <a class="reference internal" href="#ftbl2xgmml-cytoscape-view">ftbl2xgmml: cytoscape view</a> paragraph to know how to produce files importable in Cytoscape from a given MTF set. User’s manual of Cytoscape has necessary information about using visual mapper for teaching how some values like net flux values can be mapped on graphical elements like edge width and so on.</p>
</section>
<section id="problematic-cases">
<h2>Problematic cases<a class="headerlink" href="#problematic-cases" title="Permalink to this heading">¶</a></h2>
<p>Obviously, everyone would like be able just run a flux estimation software and simply get results, but unfortunately it does not work in this way every time.
In this section, we review some problematic cases which can be encountered in practice.</p>
<section id="structurally-non-identifiable-fluxes">
<h3>Structurally non-identifiable fluxes<a class="headerlink" href="#structurally-non-identifiable-fluxes" title="Permalink to this heading">¶</a></h3>
<p>It can happen that collected data are not sufficient to resolve some fluxes in your network. Due to the non-linear nature of the issue, this situation can appear for some set of free flux values and disappear for others, or be persistent for any free flux values. An error is reported to signal such situation, e.g.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>lsi: Rank deficient matrix in least squares
1 unsolvable variable(s):
f.n.PPDK        7
</pre></div>
</div>
<p>and execution is stopped.</p>
<p>Various options are then available for a user facing such situation.</p>
<ol class="arabic simple">
<li><p>Collect more data to resolve lacking fluxes. As a rule of thumb, data must be collected on species which are the nodes of convergence of badly defined fluxes or on species situated downhill of convergence point and preserving labeling pattern. The nature of collected data can also be important. Examples can be constructed where mass data are not sufficient to determine a flux but RMN data can do the job.</p></li>
</ol>
<blockquote>
<div><p>Before using real data collection, you can make a “dry run” with <code class="docutils literal notranslate"><span class="pre">--noopt</span></code> option and with fictitious or even NA values for intended to collect Isospecie in the .miso file. Thus, we can see if, with these new data, the network becomes well resolved. How? If the error message disappear and SD values in the section <code class="docutils literal notranslate"><span class="pre">linear</span> <span class="pre">stats</span></code> are not very high then chances are that additionally collected data can help to resolve the fluxes.</p>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>Optimize input label. It can happen that you do collect data on a specie situated in convergence point for undefined fluxes, but incoming fluxes are bringing the same labeling pattern which prevents flux(es) to be resolved. May be changing substrate label can help in this situation. For label optimization you can use a software called IsoDesign, distributed under OpenSource licence and available here <a class="reference external" href="http:://metatoul.insa-toulouse.fr/metasys/software/isodes/">http:://metatoul.insa-toulouse.fr/metasys/software/isodes/</a> (may be you have received <code class="docutils literal notranslate"><span class="pre">influx_si</span></code> as part of IsoDesign package, in which case you have it already).</p></li>
</ol>
<blockquote>
<div><p>Naturally, this label optimization should be done before doing actual experiments. See IsoDesing tutorial for more details on how to prepare and make such optimization.</p>
<p>If you don’t want or don’t have a possibility to use a software for label optimization or you think to have an insight on what should be changed in substrate labeling to better define the fluxes, you can still make a try with <code class="docutils literal notranslate"><span class="pre">influx_s.py</span> <span class="pre">--noopt</span> <span class="pre">--prefix</span> <span class="pre">mynetwork</span> <span class="pre">--mtf</span> <span class="pre">new_label.linp</span></code> to see if a new labeling will do the job (here <code class="docutils literal notranslate"><span class="pre">new_label.linp</span></code> is an example name for a <code class="docutils literal notranslate"><span class="pre">.linp</span></code> file set that you will prepare with new entries. It is important that <code class="docutils literal notranslate"><span class="pre">--mtf</span> <span class="pre">new_label.linp</span></code> comes after <code class="docutils literal notranslate"><span class="pre">--prefix</span> <span class="pre">mynetwork</span></code> to take precedence over the old one <code class="docutils literal notranslate"><span class="pre">mynetwork.linp</span></code>)</p>
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p>Use <code class="docutils literal notranslate"><span class="pre">--ln</span></code> option. It won’t make your fluxes well-defined, it will just continue calculation trying to resolve what can be solved and assigning some particular values (issued from so-called <em>least norm</em> solution for rank deficient matrices) to undefined fluxes. You will still have a warning similar to:</p></li>
</ol>
<blockquote>
<div><div class="highlight-text notranslate"><div class="highlight"><pre><span></span>lsi_ln: Rank deficient matrix in least squares
1 free variable(s):
f.n.PPDK        7
Least L2-norm solution is provided.
</pre></div>
</div>
<p>informing you that some flux(es) in the network is(are) still undefined. This option can be helpful if undefined fluxes are without particular interest for the biological question in hand and their actual values can be safely ignored.</p>
</div></blockquote>
<ol class="arabic simple" start="4">
<li><p>You can give an arbitrary fixed value to an undefined flux by declaring it as constrained in the <code class="docutils literal notranslate"><span class="pre">.tvar</span></code> file (letter <code class="docutils literal notranslate"><span class="pre">C</span></code> in the column <code class="docutils literal notranslate"><span class="pre">Type</span></code> followed by some value in <code class="docutils literal notranslate"><span class="pre">Value</span></code> column).</p></li>
</ol>
</section>
<section id="badly-defined-fluxes">
<h3>Badly defined fluxes<a class="headerlink" href="#badly-defined-fluxes" title="Permalink to this heading">¶</a></h3>
<p>Also known as <em>statistically undefined fluxes</em>, these fluxes have big or even huge SD values. The difference between these fluxes and structurally undefined fluxes is that the badly defined fluxes can become well defined if the noise is reduced or hypothetically eliminated. While the latter will still be undetermined even in the absence of the noise. Despite this difference, all options presented in the previous section are applicable here (all but <code class="docutils literal notranslate"><span class="pre">--ln</span></code> which would be without effect here).</p>
<p>An additional measure can be taken which consist in experimental noise reduction. Generally, it can be done by using better protocols, better instruments or simply by increasing the measurement repetition number.</p>
<p>Once again, a use of <code class="docutils literal notranslate"><span class="pre">--noopt</span></code> with new hoped SD values in the <code class="docutils literal notranslate"><span class="pre">.miso</span></code> file can help to see if these new measurements with better noise characteristics will resolve or not the problem.</p>
</section>
<section id="slow-convergence">
<h3>Slow convergence<a class="headerlink" href="#slow-convergence" title="Permalink to this heading">¶</a></h3>
<p>Slow optimization convergence can manifest by following warnings:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>nlsic: Maximal non linear iteration number is achieved
</pre></div>
</div>
<p>or/and</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>nlsic: Maximal backtrack iteration number is achieved
</pre></div>
</div>
<p>Theoretically, user can increase the limit for those two numbers
(<code class="docutils literal notranslate"><span class="pre">optctrl:nlsic:maxit</span></code> and <code class="docutils literal notranslate"><span class="pre">optctrl:nlsic:btmaxit</span></code> respectively in the <code class="docutils literal notranslate"><span class="pre">.opt</span></code> file) but generally it is not a good idea. It can help only in very specific situations that we cannot analyze here, as we estimate them low probable.
In all cases, a slow convergence is due to high non-linearity of the solved problem. What can vary from one situation to another, it is the nature of this non-linearity. Depending on this nature, several steps can be undertaken to accelerate optimization:</p>
<ol class="arabic simple">
<li><p>If a non-linearity causing the slow convergence is due to the use of function absolute value <span class="math notranslate nohighlight">\(|x|\)</span> in the calculation of forward and revers fluxes from net and exchange fluxes, then an option <code class="docutils literal notranslate"><span class="pre">--zc=ZC</span></code> (zero crossing) can be very efficient. This non-linearity can become harmful when during optimization a net flux has to change its sign, in other words, it has to cross zero.</p></li>
</ol>
<blockquote>
<div><p>This option splits the convergence process in two parts. First, a minimum is searched for fluxes under additional constraints to keep the same sign during this step. Second, for fluxes that reached zero after the first step, a sign change is imposed, and a second optimization is made with these new constraints.
If <code class="docutils literal notranslate"><span class="pre">--zc</span></code> option is used with an argument 0 (<code class="docutils literal notranslate"><span class="pre">--zc=0</span></code> or <code class="docutils literal notranslate"><span class="pre">--zc</span> <span class="pre">0</span></code>), it can happen that fluxes reaching zero produce a singular (non invertible) cumomer balance matrix. In this case, an execution is aborted with an error starting like</p>
<blockquote>
<div><div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Cumomer matrix is singular. Try &#39;--clownr N&#39; or/and &#39;--zc N&#39; options with small N, say 1.e-3 or constrain some of the fluxes listed below to be non zero
...
</pre></div>
</div>
</div></blockquote>
<p>To avoid such situation, an argument to <code class="docutils literal notranslate"><span class="pre">--zc</span></code> must be a small positive number, say <code class="docutils literal notranslate"><span class="pre">--zc</span> <span class="pre">0.001</span></code>. In this case, positive net fluxes are kept over 0.001 and negative fluxes are kept under -0.001 value. In this manner, an exact zero is avoided.</p>
<p>Another way to avoid problem induced by using module function <span class="math notranslate nohighlight">\(|x|\)</span> is to add inequality(-ies) imposing sens of reaction in <code class="docutils literal notranslate"><span class="pre">.cnstr</span></code> file e.g.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Id      Comment Kind    Formula Operator        Value
                NET     mae     &gt;<span class="o">=</span>              <span class="m">0</span>
</pre></div>
</div>
<p>Naturally, in this example, you have to be sure that the reaction catalyzed by malic enzyme (here <code class="docutils literal notranslate"><span class="pre">mae</span></code>) must go in the sens written in your <code class="docutils literal notranslate"><span class="pre">.netw</span></code> file.</p>
<p>You can find potential candidates to impose sens of reaction by examining the flux values in <code class="docutils literal notranslate"><span class="pre">mynetwork_res.kvh</span></code> after a slow convergence and looking fluxes whose sign (positive or negative) looks suspicious to you. In our practice, we could observe a dramatic increase in convergence speed and stability just after imposing sens of reaction to a “key” reaction. Obviously, such constraint must be in accordance with biological sens of a studied network and its biological condition.</p>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>A high non-linearity can appear for some particular set of fluxes, especially when they take extreme values. E.g., when exchange fluxes are close to 1 or net fluxes take very high values of order 10² or even 10³ (supposing that the main entry flux is normalized to 1). In such a case, user can low this limits (options <code class="docutils literal notranslate"><span class="pre">--cupx=CUPX</span></code> and <code class="docutils literal notranslate"><span class="pre">--cupn=CUPN</span></code> respectively) or try to exclude outliers (<code class="docutils literal notranslate"><span class="pre">--excl_outliers</span> <span class="pre">P-VALUE</span></code>) as outliers can attract the solution in weird zone of fluxes. In this latter case, the first convergence will continue to be slow and will generate corresponding warnings but the second one (after a possible automatic elimination of outliers) can converge much faster.</p></li>
</ol>
</section>
<section id="convergence-aborted">
<h3>Convergence aborted<a class="headerlink" href="#convergence-aborted" title="Permalink to this heading">¶</a></h3>
<p>This situation is signaled by an error message:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>nlsic: LSI returned not descending direction
</pre></div>
</div>
<p>This problem can occur for badly defined network, which are very sensitive to truncation errors. The effect of such errors can become comparable to the effect of the increment step during optimization. It means that we cannot decrease the norm of residual vector under the values resulting from rounding errors.
If it happens for relatively small increments, then the results of convergence are still exploitable. If not, there is no so many actions that user could undertake except to make his system better defined as described in previous sections.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>By default, we use a very small value for increment norm as stopping criterion (<span class="math notranslate nohighlight">\(10^{-5}\)</span>). It can be considered as very drastic criterion and can be relaxed to <span class="math notranslate nohighlight">\(10^{-3}\)</span> or <span class="math notranslate nohighlight">\(10^{-2}\)</span> depending on required precision for a problem in hand (to do that, use an option <code class="docutils literal notranslate"><span class="pre">optctrl:nlsic:errx</span></code> in the <code class="docutils literal notranslate"><span class="pre">.opt</span></code> file).</p>
</div>
</section>
</section>
<section id="additional-tools">
<h2>Additional tools<a class="headerlink" href="#additional-tools" title="Permalink to this heading">¶</a></h2>
<p>Tools described in this section are not strictly necessary for running <code class="docutils literal notranslate"><span class="pre">influx_si</span></code> and calculating the fluxes. But in some cases, they can facilitate the task of tracking and solving potential problems in FTBL preparation and usage.</p>
<p>Most of the utilities produce an output written on standard output or in a file whose name is derived from the input file name. This latter situation is signaled with a phrase “The output redirection is optional” and in the usage examples the output redirection is taken in square brackets <code class="docutils literal notranslate"><span class="pre">[&gt;</span> <span class="pre">output.txt]</span></code> which obviously should be omitted if an actual redirection is required. Such behavior is particularly useful for drag-and-drop usage.</p>
<section id="ftbl2mtf-conversion-of-ftbl-to-mtf-format">
<h3>ftbl2mtf: conversion of FTBL to MTF format<a class="headerlink" href="#ftbl2mtf-conversion-of-ftbl-to-mtf-format" title="Permalink to this heading">¶</a></h3>
<p>For old <code class="docutils literal notranslate"><span class="pre">influx_si</span></code> users having their projects in FTBL format, this utility can be an invaluable helper for making the transition to the new MTF format. Here is the help message, which can be seen with <code class="docutils literal notranslate"><span class="pre">ftbl2mtf</span> <span class="pre">-h</span></code></p>
<blockquote>
<div><div class="highlight-text notranslate"><div class="highlight"><pre><span></span>usage: ftbl2mtf [-h] [-i] [-f] [-o OUT] ftbl

Parse ftbl file from first parameter or from stdin (if input file is &#39;-&#39;)
and write a series of mtf (multiple TSV files).
The file stem (&#39;network&#39; in &#39;network.ftbl&#39;) is used as file name basis
for produced files, e.g. &#39;network.miso&#39;. Parameter --out can be used to change it.
If out path includes non existing directories, they are automatically created.
Caution! If an existing output file starts with a comment
&quot;# Created by &#39;ftbl2mft ...&quot;
or is empty, it is silently overwritten.
Otherwise, the writing is aborted with a warning. Other files may continue to be created.
To force the overwriting, use &#39;--force&#39;.

Output files will have following extensions/meanings:

 .netw: stoichiometric equations and label transitions in the biochemical network;
 .linp: label input;
 .miso: isotopic measurements (MS, label, peak);
 .mflux: flux measurements;
 .mmet: biochemical specie concentration measurements;
 .tvar: flux/specie types partition (free, dependent, constrained) and starting values;
 .cnstr: constraints (equalities, inequalities for both fluxes and concentrations);
 .opt: options.

Copyright 2022 INRAE, INSA, CNRS
Author: Serguei Sokol (sokol [at] insa-toulouse [dot] fr)

positional arguments:
  ftbl               input file to be converted to MTF

optional arguments:
  -h, --help         show this help message and exit
  -i, --inst         activate instationary mode
  -f, --force        force overwriting of result files
  -o OUT, --out OUT  path prefix for result files
</pre></div>
</div>
</div></blockquote>
</section>
<section id="txt2ftbl-conversion-of-mtf-format-to-ftbl-format">
<h3>txt2ftbl: conversion of MTF format to FTBL format<a class="headerlink" href="#txt2ftbl-conversion-of-mtf-format-to-ftbl-format" title="Permalink to this heading">¶</a></h3>
<p>This tool is implicitly used by <code class="docutils literal notranslate"><span class="pre">influx_si</span></code> to convert MTF to FTBL format. Users desiring to play with format conversion or to produce FTBL file to be used with <a class="reference internal" href="#additional-tools">Additional tools</a> can use it explicitly. Here is its help message:</p>
<blockquote>
<div><div class="highlight-text notranslate"><div class="highlight"><pre><span></span>usage: txt2ftbl [-h] [--mtf MTF] [--prefix PREFIX] [--eprl EPRL] [--inst] [--force] [netw]

transform a series of TXT and TSV files into FTBL file.

Copyright 2021, INRAE, INSA, CNRS
Author: Serguei Sokol (sokol at insa-toulouse dot fr)
License: Gnu Public License (GPL) v2 http://www.gnu.org/licenses/gpl.html

positional arguments:
  netw
                   If &#39;netw&#39; file is not given in any option (neither --mtf nor --prefix), it
                   can be given as the only argument NETW, e.g.
                     txt2ftbl ecoli.txt
                   or
                     txt2ftbl --mtf ms_nmr_data.miso,glucose.linp ecoli.txt
                   If &#39;netw&#39; file name is given both in any option and as an argument, it
                   is the argument value that will take precedence.

optional arguments:
  -h, --help       show this help message and exit
  --mtf MTF        MTF is a coma separated list of files with following extensions/meanings:
                    netw: a text file with stoichiometric reactions and label transitions (one per line)
                       Comments starts with &#39;#&#39; but those starting with &#39;###&#39; introduce
                       pathways which are numbered as well as reactions in them. Reaction
                       name can precede the reaction itself and is separated by &quot;:&quot; If no
                       explicit name is given, reactions in FTBL file will be named
                       according a pattern &#39;rX.Y&#39; where X is pathway number and Y is
                       reaction number in the pathway. But it is highly recommended to
                       give explicit names to reactions.
                       Symbols &quot;+&quot;, &quot;(&quot;, &quot;)&quot; and &quot;:&quot; are not allowed in metabolite neither reaction names
                       Example of reaction and label transition:
                          edd: Gnt6P (ABCDEF) -&gt; Pyr (ABC) + GA3P (DEF)
                       Non reversible reactions are signaled with &#39;-&gt;&#39; (as in the example above).
                       A sign &#39;&lt;-&gt;&#39; can be used for reversible reactions.
                       If &#39;netw&#39; name is equal to &#39;-&#39;, then its content is read from standard input, e.g.
                         &#39;--mtf netw=-&#39;
                    linp: label inputs (starting from this extensions, TSV files are assumed)
                    miso: isotopic measurements (NMR (label, peak) and MS)
                    mflux: flux measurements
                    mmet: metabolite concentration measurements
                    tvar: type of variables (NET or XCH , free or dependent, starting values, ...)
                    cnstr: equality and inequality constraints on fluxes and concentrations
                    opt: options
                    ftbl: name of output FTBL file. If not given, it will be equal to &#39;netw&#39;
                      stem with &#39;.ftbl&#39; extension. If it is equal to &#39;-&#39;, then the result
                      will be written to standard output, e.g.
                        &#39;txt2ftbl --mtf ftbl=-,ecoli.netw&#39;
                      Intermediate directories in ftbl path are silently created if non existent.
                    vmtf: variable part of mtf approach.
                      If a series of FTBL files has to be generated partially with
                      information common to all files (constant part) and partially with
                      sections proper to each FTBL (variable part) then files containing
                      variable sections (e.g. &#39;miso&#39;) can be given in a special file
                      having an extension (or prefix, cf. hereafter) &#39;vmtf&#39;. In such a
                      way, each FTBL file will be produced from combination of MTF files
                      given directly in this option (constant part) and files given on a
                      corresponding row of &#39;vmtf&#39; file. vmtf file is a TSV file with
                      columns using the same names: &#39;netw&#39;, &#39;linp&#39;, etc. Each row contains
                      file names that will be used to produce an FTBL file. Thus each row
                      must have &#39;ftbl&#39; column with unique and non empty name. When &#39;vmtf&#39;
                      is used, &#39;ftbl&#39; cannot be present on the command line. If a file
                      type is present both in column names of &#39;vmtf&#39; and in &#39;--mtf&#39; option
                      then the content of &#39;vmtf&#39; file will take precedence. Empty values
                      in &#39;vmtf&#39; file are ignored. All file paths in &#39;vmtf&#39; file are
                      considered relative to the location of &#39;vmtf&#39; file itself.
                   Only first 3 files are necessary to obtain a workable FTBL file, others
                   are optional.
                   Example: &#39;txt2ftbl --mtf ecoli.netw,glu08C1_02U.linp,cond1.miso,cond1.mflux&#39;
                   NB: no space is allowed around comas. If a file path has a spaces in
                   its name, it must be enclosed into quotes or double quotes.
                   If an entry file cannot be renamed to have some of these extensions, then
                   they can be used as prefixes followed by a &#39;=&#39; sign, e.g.
                     &#39;txt2ftbl --mtf netw=ecoli.txt,linp=glu08C1_02U.tsv,cond1.miso,cond1.mflux&#39;
                   As you can see from this example, both naming schemes can be mixed.
                   If for some reason, the same type of file is indicated several times
                   (no matter with extension or prefix), the last occurrence supersedes
                   all precedent ones.
  --prefix PREFIX  If all input files have the same name pattern and are different only
                   in extensions then the pattern can be given as PREFIX, e.g.
                     &#39;--prefix somedir/ecoli&#39;
                   Then in &#39;somedir&#39;, we suppose to have &#39;ecoli.netw&#39;, &#39;ecoli.linp&#39; and
                   other input files having names starting with &#39;ecoli&#39; and ending with
                   corresponding extensions.
                   NB. If some file is given in more than one option: &#39;--prefix&#39; and/or
                   &#39;--mtf&#39; then the last occurrence overrides precedent ones.
  --eprl EPRL      Parallel experiments can be given with this option. It must
                   introduce a couple of linp/miso files and optional auxiliary ftbl name. These files
                   correspond to a given parallel experiment. This option can be repeated as
                   many times as there are additional parallel experiments, e.g.
                     &#39;txt2ftbl --mtf ec.netw,glc6.linp,glc6.miso --eprl glc1.linp,glc1.miso --eprl glc4.linp,glc4.miso&#39;
                   This command will produce a main FTBL file &#39;ec.ftbl&#39; including all necessary
                   sections (NETWORK, etc.) but also two auxiliary FTBL files: &#39;glc1.ftbl&#39; and
                   &#39;glc4.ftbl&#39; having only label input/measurement sections. They will correspond
                   to 2 additional parallel experiments. If ftbl file is not given in --eprl
                   option, the name of miso file will be used for it. If intermediate
                   directories in ftbl path are non existent they will be silently created.
                   Auxiliary ftbl names will be put in &#39;OPTIONS/prl_exp&#39; field on the main ftbl file.
                   These names will be written there in a form relative to the main ftbl.
                   To shorten the writings, it is possible to indicate only one of two .miso/.linp files.
                   The other one will be guessed if it has canonical extension. If extension is omitted then .miso and .linp files are searched with these extensions. In this case, several parallel experiments can be given with one --eprl option. So that above example can be shorten to:
                     &#39;txt2ftbl --mtf ec.netw,glc6.linp,glc6.miso --eprl glc1,glc4&#39;
  --inst           Prepare FTBL for instationary case. File &#39;netw&#39; is supposed to have
                   column &#39;Time&#39; non empty. Isotopic kinetic data will be written to a TSV
                   file with &#39;ikin&#39; extension. Its name will be the same as in FTBL file,
                   and FTBL field &#39;OPTIONS/file_labcin&#39; will contain &#39;ikin&#39; file name.
  --force          Overwrite an existent result file not produced by this script.
                   NB. If a result file exists and is actually produced by this script,
                   then it is silently overwritten even without this option. The script
                   detects if it was the creator of a file by searching for a string &quot;//
                   Created by &#39;txt2ftbl&quot; at the first line of the file. By removing or
                   editing this comment, user can protect a file from a silent
                   overwriting.
</pre></div>
</div>
</div></blockquote>
</section>
<section id="ftbl2xgmml-cytoscape-view">
<h3>ftbl2xgmml: Cytoscape view<a class="headerlink" href="#ftbl2xgmml-cytoscape-view" title="Permalink to this heading">¶</a></h3>
<p>Once a valid MTF set (or FTBL file) is generated, a user can visualize a graph representing his metabolic network in <a class="reference external" href="https://www.cytoscape.org">Cytoscape</a> program. To produce necessary graph files, user can run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ ftbl2xgmml.py --prefix mynetwork <span class="o">[</span>&gt; mynetwotk.xgmml<span class="o">]</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ ftbl2xgmml.py mynetwork<span class="o">[</span>.ftbl<span class="o">]</span> <span class="o">[</span>&gt; mynetwotk.xgmml<span class="o">]</span>
</pre></div>
</div>
<p>or drag and drop <code class="docutils literal notranslate"><span class="pre">mynetwork.ftbl</span></code> icon on <code class="docutils literal notranslate"><span class="pre">ftbl2xgmml.py</span></code> icon.</p>
<p>The output redirection is optional.</p>
<p>This will produce a file in the XGMML format <code class="docutils literal notranslate"><span class="pre">mynetwork.xgmml</span></code> in the directory of <code class="docutils literal notranslate"><span class="pre">mynetwork.netw</span></code> or <code class="docutils literal notranslate"><span class="pre">mynetwork.ftbl</span></code>:</p>
<p>Once a generated file <code class="docutils literal notranslate"><span class="pre">mynetwork.xgmml</span></code> is imported in cytoscape, a user can use one of automatic cytoscape layouts (e.g. ‘Prefuse Force Directed Layout’) or edit node’s disposition in the graph by hand.
For those who use <a class="reference external" href="http://apps.cytoscape.org/apps/cysbml">CySBML</a> plugin, a saving of a particular layout in a file can be practical for later applying it to a new network.</p>
<p>Graphical conventions used in the generated XGMML are the following:</p>
<ul>
<li><p>specie are presented as rounded square nodes;</p></li>
<li><p>simple (one to one) reaction are represented by simple edges;</p></li>
<li><p>condensing and/or splitting reactions are represented by edges converging and/or diverging from an additional almost invisible node having a label with the reaction name;</p></li>
<li><p>all nodes and edges have tool tips, i.e., when a pointer is put over, their name (specie or reaction) appears in a tiny pop-up window;</p></li>
<li><p>non-reversible reactions are represented by a single solid line, have an arrow on the target end (i.e., produced specie) and nothing on the source end (i.e., consumed specie);</p></li>
<li><p>reversible reactions are represented by a double parallel line and have a solid circle on the source end;</p></li>
<li><p>color code for arrows:</p>
<blockquote>
<div><ul class="simple">
<li><p>green for free net flux;</p></li>
<li><p>blue for dependent net flux;</p></li>
<li><p>black for constrained net flux;</p></li>
</ul>
</div></blockquote>
</li>
<li><p>color code for solid circles:</p>
<blockquote>
<div><ul class="simple">
<li><p>green for free exchange flux;</p></li>
<li><p>blue for dependent exchange flux;</p></li>
<li><p>black for constrained exchange flux.</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</section>
<section id="ftbl2netan-mtf-ftbl-parsing">
<h3>ftbl2netan: MTF/FTBL parsing<a class="headerlink" href="#ftbl2netan-mtf-ftbl-parsing" title="Permalink to this heading">¶</a></h3>
<p>To see how MTF/FTBL files are parsed and what the parsing module “understands” in the network, a following command can be run:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ ftbl2netan.py --prefix mynetwork <span class="o">[</span>&gt; mynetwork.netan<span class="o">]</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ ftbl2netan.py mynetwork<span class="o">[</span>.ftbl<span class="o">]</span> <span class="o">[</span>&gt; mynetwork.netan<span class="o">]</span>
</pre></div>
</div>
<p>The output redirection is optional.</p>
<p>A user can examine <code class="docutils literal notranslate"><span class="pre">mynetwork.netan</span></code> in <a class="reference external" href="https://vkvh.readthedocs.io">vkvh</a> software or in a plain text editor (not like Word) or in spreadsheet software. It has an hierarchical structure, the fields are separated by tabulations and the field values are Python objects converted to strings.</p>
</section>
<section id="ftbl2cumoab-human-readable-equations">
<h3>ftbl2cumoAb: human-readable equations<a class="headerlink" href="#ftbl2cumoab-human-readable-equations" title="Permalink to this heading">¶</a></h3>
<p>Sometimes, it can be helpful to examine visually the equations used by <code class="docutils literal notranslate"><span class="pre">influx_si</span></code>. These equations can be produced in human-readable form by running:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ ftbl2cumoAb.py -r --prefix mynetwork <span class="o">[</span>&gt; mynetwork.sys<span class="o">]</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ ftbl2cumoAb.py -r mynetwork<span class="o">[</span>.ftbl<span class="o">]</span> <span class="o">[</span>&gt; mynetwork.sys<span class="o">]</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ ftbl2cumoAb.py --emu mynetwork<span class="o">[</span>.ftbl<span class="o">]</span> <span class="o">[</span>&gt; mynetwork.sys<span class="o">]</span>
</pre></div>
</div>
<p>The output redirection is optional.</p>
<p>The result file <code class="docutils literal notranslate"><span class="pre">mynetwork.sys</span></code> will contain systems of stoichiometric and cumomer balance equations as well as a symbolic inversion of stoichiometric matrix. I.e., dependent fluxes are represented as a linear combination of free and constrained fluxes and an optional constant value. In the examples above, the option <code class="docutils literal notranslate"><span class="pre">-r</span></code> stands for “reduced cumomer set” and <code class="docutils literal notranslate"><span class="pre">--emu</span></code> stands for “generate EMU framework equations”. In this latter case, only isotopologues of mass+0 in each EMU are reported in <code class="docutils literal notranslate"><span class="pre">mynetwork.sys</span></code> file. For other mass weights, the equations does not change and the right-hand side term could get longer for condensation reactions but involves the same EMUs as in mass+0 weight.</p>
<p>If a full cumomer set has to be examined, just omit all options. Keep in mind that on real-world networks this can produce more than a thousand equations by cumomer weight, which could hardly be qualified as <em>human</em>-readable form. So use it with caution.</p>
<p>For the sake of brevity, cumomer names are encoded in decimal integer form. For example, a cumomer <code class="docutils literal notranslate"><span class="pre">Metab#xx1x</span></code> will be referred as <code class="docutils literal notranslate"><span class="pre">Metab:2</span></code> because a binary number <code class="docutils literal notranslate"><span class="pre">0010</span></code> corresponds to a decimal number <code class="docutils literal notranslate"><span class="pre">2</span></code>. The binary mask <code class="docutils literal notranslate"><span class="pre">0010</span></code> is obtained from the cumomer mask <code class="docutils literal notranslate"><span class="pre">xx1x</span></code> by a plain replacement of every <code class="docutils literal notranslate"><span class="pre">x</span></code> by <code class="docutils literal notranslate"><span class="pre">0</span></code>.</p>
<p>For a given cumomer weight, the equations are sorted alphabetically.</p>
</section>
<section id="expa2ftbl-non-carbon-carrying-fluxes">
<h3>expa2ftbl: non-carbon carrying fluxes<a class="headerlink" href="#expa2ftbl-non-carbon-carrying-fluxes" title="Permalink to this heading">¶</a></h3>
<p>Deprecated since v6.0. Such kind of fluxes can be directly incorporated in .netw file.</p>
<p>Some reactions of carbon metabolism require cofactor usage like ATP/ADP and some others. A mass balance on cofactors can produce additional useful constraints on the stoichiometric system. Since the version 2.8, such mass balance equation on non carbon carrying species can be put in <code class="docutils literal notranslate"><span class="pre">EQUATION</span></code> section of FTBL file. A utility <code class="docutils literal notranslate"><span class="pre">expa2ftbl.R</span></code> can be helpful for this purpose if a user has already a full set of reactions in <a class="reference external" href="http://gcrg.ucsd.edu/Downloads/ExtremePathwayAnalysis">expa</a> format.
To extract additional equation from an expa file, <code class="docutils literal notranslate"><span class="pre">expa2ftbl.R</span></code> can be used as:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ R --vanilla --slave --args file.expa &lt; expa2ftbl.R &gt; file.ftbl_eq
</pre></div>
</div>
<p>Then an information for the generated <code class="docutils literal notranslate"><span class="pre">file.ftbl_eq</span></code> has to be manually copy/pasted to a corresponding FTBL file.</p>
<p>Note that <code class="docutils literal notranslate"><span class="pre">expa2ftbl.R</span></code> uses a Unix command <code class="docutils literal notranslate"><span class="pre">grep</span></code> and another utility described here above <code class="docutils literal notranslate"><span class="pre">ftbl2netan.py</span></code>.</p>
</section>
<section id="res2ftbl-meas-simulated-data">
<h3>res2ftbl_meas: simulated data<a class="headerlink" href="#res2ftbl-meas-simulated-data" title="Permalink to this heading">¶</a></h3>
<div class="admonition note" id="ex-sim1">
<p class="admonition-title">Note</p>
<p>Deprecated since v7.0. User can use <code class="docutils literal notranslate"><span class="pre">.miso.sim</span></code>, <code class="docutils literal notranslate"><span class="pre">.mflux.sim</span></code> and <code class="docutils literal notranslate"><span class="pre">.mmet.sim</span></code> as measurement files in a new calculation. E.g.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>influx_s --pref mynetwork --mtf \
miso=mynetwork_res/mynetwork.miso.sim,\
mflux=mynetwork_res/mynetwork.mflux.sim \
-o tmp
</pre></div>
</div>
<p>here, new output directory <code class="docutils literal notranslate"><span class="pre">tmp</span></code> is used to avoid an overwriting of previous results.</p>
</div>
<p>During preparation of a study, one of the questions that biologist can ask is “Will the intended collected data be sufficient for flux resolution in a given network?”
Some clue can be obtained by making “dry runs” of <code class="docutils literal notranslate"><span class="pre">influx_si</span></code> with <code class="docutils literal notranslate"><span class="pre">--noopt</span></code> (i.e. no optimization) option. User can prepare an FTBL file with a given network and supposed data to be collected. At first, the measurement values can be replaced by NAs while the SD values for measurements must be given in realistic manner. After running:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ influx_s.py --noopt mynetwork
</pre></div>
</div>
<p>a utility <code class="docutils literal notranslate"><span class="pre">res2ftbl_meas.py</span></code> can be practical for preparing FTBL files with obtained simulated measurements:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ res2ftbl_meas.py res2ftbl_meas.py mynetwork_res<span class="o">[</span>.kvh<span class="o">]</span> &gt; mynetwork.ftbl_meas
</pre></div>
</div>
<p>(here <code class="docutils literal notranslate"><span class="pre">.kvh</span></code> suffix is optional). The information from the generated file <code class="docutils literal notranslate"><span class="pre">mynetwork.ftbl_meas</span></code> has to be manually copy/pasted into the corresponding FTBL file.
Getting an ftbl file with real values instead of NAs in measurement sections gives an opportunity to explore optimization behavior near a simulated point like convergence speed and/or convergence stability to cite few of them.</p>
</section>
<section id="ffres2ftbl-import-free-fluxes">
<h3>ffres2ftbl: import free fluxes<a class="headerlink" href="#ffres2ftbl-import-free-fluxes" title="Permalink to this heading">¶</a></h3>
<div class="admonition note" id="ex-sim2">
<p class="admonition-title">Note</p>
<p>Deprecated since v7.0. User can use <code class="docutils literal notranslate"><span class="pre">.tvar.sim</span></code> as starting values in a new calculation. E.g.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>influx_s --pref mynetwork --mtf \
tvar=mynetwork_res/mynetwork.tvar.sim \
-o tmp
</pre></div>
</div>
<p>here, new output directory <code class="docutils literal notranslate"><span class="pre">tmp</span></code> is used to avoid an overwriting of previous results.</p>
</div>
<p>This utility imports free flux values and specie concentrations (if any) from a result file _res.kvh and inject them into an FTBL file. Usage:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ ffres2ftbl.sh mynetwork_res.kvh <span class="o">[</span>base.ftbl<span class="o">]</span> &gt; new.ftbl
</pre></div>
</div>
<p>If an optional argument <code class="docutils literal notranslate"><span class="pre">base.ftbl</span></code> is omitted, then the free flux values are injected into an FTBL file corresponding to the _res.kvh file (here <code class="docutils literal notranslate"><span class="pre">mynetwork.ftbl</span></code>). This script can be used on a Unix (e.g., Linux, MacOS) or on a cygwin (Unix tools on Windows) platform. It makes use of another utility written in python <code class="docutils literal notranslate"><span class="pre">ff2ftbl.py</span></code></p>
</section>
<section id="ftbl2kvh-check-mtf-ftbl-parsing">
<h3>ftbl2kvh: check MTF/FTBL parsing<a class="headerlink" href="#ftbl2kvh-check-mtf-ftbl-parsing" title="Permalink to this heading">¶</a></h3>
<p>This utility simply parses MTF/FTBL files and write what was “understood” to a kvh file. No network analysis occurs here unlike in <code class="docutils literal notranslate"><span class="pre">ftbl2netan</span></code> utility. Usage:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ ftbl2kvh.py --prefix mynetwork <span class="o">[</span>&gt; mynetwork.kvh<span class="o">]</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ ftbl2kvh.py mynetwork<span class="o">[</span>.ftbl<span class="o">]</span> <span class="o">[</span>&gt; mynetwork.kvh<span class="o">]</span>
</pre></div>
</div>
<p>The output redirection is optional.
The resulting <code class="docutils literal notranslate"><span class="pre">mynetwork.kvh</span></code> is tab-separated plain text file. So it can be explored in <a class="reference external" href="https://vkvh.readthedocs.io">vkvh</a> software, plain text editor or spreadsheet software.</p>
</section>
<section id="ftbl2metxml-prepare-metexplore-visualization">
<h3>ftbl2metxml: prepare <a class="reference external" href="https://metexplore.toulouse.inra.fr/">MetExplore</a> visualization<a class="headerlink" href="#ftbl2metxml-prepare-metexplore-visualization" title="Permalink to this heading">¶</a></h3>
<p>Convert a MTF sets (or FTBL files) to an xml files suitable for visualization on <a class="reference external" href="https://metexplore.toulouse.inra.fr/">MetExplore</a> site. If a result kvh file <code class="docutils literal notranslate"><span class="pre">mynetwork_res.kvh</span></code> is present, it will be parsed to extract flux values corresponding to the last <code class="docutils literal notranslate"><span class="pre">influx_si</span></code> run and put them in <code class="docutils literal notranslate"><span class="pre">mynetwok_net.txt</span></code>, <code class="docutils literal notranslate"><span class="pre">mynetwork_fwd.txt</span></code> and <code class="docutils literal notranslate"><span class="pre">mynetwork_rev.txt</span></code>. As their names indicate, they will contain net, forward and revers flux values respectively.</p>
</section>
<section id="isodesign-optimizing-input-label">
<h3>IsoDesign: optimizing input label<a class="headerlink" href="#isodesign-optimizing-input-label" title="Permalink to this heading">¶</a></h3>
<p>One of the means to increase a flux resolution can be an optimization of input label composition. A utility <code class="docutils literal notranslate"><span class="pre">IsoDesing</span></code> solving this problem was developed by Pierre Millard. It is not part of <code class="docutils literal notranslate"><span class="pre">influx_si</span></code> distribution and can be downloaded at <a class="reference external" href="http://metatoul.insa-toulouse.fr/metasys/software/isodes/">http://metatoul.insa-toulouse.fr/metasys/software/isodes/</a>. In a nutshell, it works by scanning all possible input label compositions with a defined step, running <code class="docutils literal notranslate"><span class="pre">influx_si</span></code> on each of them. Then, it collects the SD information on all fluxes for all label compositions and finally selects an input label composition optimal in some sens (according to a criterion chosen by a user).</p>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">User’s manual</a><ul>
<li><a class="reference internal" href="#mtf-format">MTF format</a><ul>
<li><a class="reference internal" href="#netw">.netw</a></li>
<li><a class="reference internal" href="#linp">.linp</a></li>
<li><a class="reference internal" href="#miso">.miso</a></li>
<li><a class="reference internal" href="#mflux">.mflux</a></li>
<li><a class="reference internal" href="#mmet">.mmet</a></li>
<li><a class="reference internal" href="#cnstr">.cnstr</a></li>
<li><a class="reference internal" href="#tvar">.tvar</a></li>
<li><a class="reference internal" href="#opt">.opt</a></li>
<li><a class="reference internal" href="#vmtf">.vmtf</a></li>
</ul>
</li>
<li><a class="reference internal" href="#output-format">Output format</a><ul>
<li><a class="reference internal" href="#mynetwork-log"><code class="docutils literal notranslate"><span class="pre">mynetwork.log</span></code></a></li>
<li><a class="reference internal" href="#mynetwork-err"><code class="docutils literal notranslate"><span class="pre">mynetwork.err</span></code></a></li>
<li><a class="reference internal" href="#mynetwork-miso-sim-mynetwork-mflux-sim-mynetwork-mmet-sim"><code class="docutils literal notranslate"><span class="pre">mynetwork.miso.sim</span></code>, <code class="docutils literal notranslate"><span class="pre">mynetwork.mflux.sim</span></code>, <code class="docutils literal notranslate"><span class="pre">mynetwork.mmet.sim</span></code></a></li>
<li><a class="reference internal" href="#mynetwork-tvar-sim"><code class="docutils literal notranslate"><span class="pre">mynetwork.tvar.sim</span></code></a></li>
<li><a class="reference internal" href="#mynetwork-stat"><code class="docutils literal notranslate"><span class="pre">mynetwork.stat</span></code></a></li>
<li><a class="reference internal" href="#custom-files">Custom files</a></li>
<li><a class="reference internal" href="#old-result-files">Old result files</a></li>
</ul>
</li>
<li><a class="reference internal" href="#basic-influx-si-usage">Basic influx_si usage</a><ul>
<li><a class="reference internal" href="#influx-si-command-line-options"><code class="docutils literal notranslate"><span class="pre">influx_si</span></code> command line options</a></li>
</ul>
</li>
<li><a class="reference internal" href="#parallel-experiments">Parallel experiments</a></li>
<li><a class="reference internal" href="#options-in-opt-file">Options in .opt file</a><ul>
<li><a class="reference internal" href="#optimization-options">Optimization options</a><ul>
<li><a class="reference internal" href="#nlsic-parameters">NLSIC parameters</a></li>
<li><a class="reference internal" href="#pso-parameters">PSO parameters</a></li>
<li><a class="reference internal" href="#other-optimization-methods">Other optimization methods</a></li>
</ul>
</li>
<li><a class="reference internal" href="#growth-flux-option">Growth flux option</a></li>
<li><a class="reference internal" href="#post-treatment-option">Post treatment option</a></li>
<li><a class="reference internal" href="#exclusive-influx-i-options">Exclusive <code class="docutils literal notranslate"><span class="pre">influx_i</span></code> options</a></li>
</ul>
</li>
<li><a class="reference internal" href="#old-result-file-fields">Old Result File Fields</a></li>
<li><a class="reference internal" href="#network-values-for-cytoscape">Network values for Cytoscape</a></li>
<li><a class="reference internal" href="#problematic-cases">Problematic cases</a><ul>
<li><a class="reference internal" href="#structurally-non-identifiable-fluxes">Structurally non-identifiable fluxes</a></li>
<li><a class="reference internal" href="#badly-defined-fluxes">Badly defined fluxes</a></li>
<li><a class="reference internal" href="#slow-convergence">Slow convergence</a></li>
<li><a class="reference internal" href="#convergence-aborted">Convergence aborted</a></li>
</ul>
</li>
<li><a class="reference internal" href="#additional-tools">Additional tools</a><ul>
<li><a class="reference internal" href="#ftbl2mtf-conversion-of-ftbl-to-mtf-format">ftbl2mtf: conversion of FTBL to MTF format</a></li>
<li><a class="reference internal" href="#txt2ftbl-conversion-of-mtf-format-to-ftbl-format">txt2ftbl: conversion of MTF format to FTBL format</a></li>
<li><a class="reference internal" href="#ftbl2xgmml-cytoscape-view">ftbl2xgmml: Cytoscape view</a></li>
<li><a class="reference internal" href="#ftbl2netan-mtf-ftbl-parsing">ftbl2netan: MTF/FTBL parsing</a></li>
<li><a class="reference internal" href="#ftbl2cumoab-human-readable-equations">ftbl2cumoAb: human-readable equations</a></li>
<li><a class="reference internal" href="#expa2ftbl-non-carbon-carrying-fluxes">expa2ftbl: non-carbon carrying fluxes</a></li>
<li><a class="reference internal" href="#res2ftbl-meas-simulated-data">res2ftbl_meas: simulated data</a></li>
<li><a class="reference internal" href="#ffres2ftbl-import-free-fluxes">ffres2ftbl: import free fluxes</a></li>
<li><a class="reference internal" href="#ftbl2kvh-check-mtf-ftbl-parsing">ftbl2kvh: check MTF/FTBL parsing</a></li>
<li><a class="reference internal" href="#ftbl2metxml-prepare-metexplore-visualization">ftbl2metxml: prepare MetExplore visualization</a></li>
<li><a class="reference internal" href="#isodesign-optimizing-input-label">IsoDesign: optimizing input label</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="quick.html"
                          title="previous chapter">Quick Start</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="ftblevo.html"
                          title="next chapter">FTBL format evolution</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/manual.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="ftblevo.html" title="FTBL format evolution"
             >next</a> |</li>
        <li class="right" >
          <a href="quick.html" title="Quick Start"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">influx_si 7.0 documentation</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">User’s manual</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2012-2020, INRAE/INSA/CNRS.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 5.2.3.
    </div>
  </body>
</html>